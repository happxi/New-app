<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ìíœ´ë ˆí„° - í–…ì‚ë‹˜ ì˜¤ëŠ˜ë„ í–‰ë³µí•˜ì„¸ìš”!</title>
    <link href="https://fonts.googleapis.com/css2?family=Nanum+Round+Gothic:wght@300;400;500;700;800&family=Noto+Sans+KR:wght@300;400;500;700&display=swap" rel="stylesheet">
    <style>
        :root {
            /* ğŸ¨ V16.0 ê°ì„± ì»¬ëŸ¬ íŒ”ë ˆíŠ¸ */
            --color-primary: #4A90E2;
            --color-primary-light: #87CEEB;
            --color-secondary: #FFF0F5; /* ì—°í•œ í•‘í¬ ë°°ê²½ */
            --color-accent-pink: #FFB6C1; /* í•‘í¬ í¬ì¸íŠ¸ */
            --color-glass-white: rgba(255, 255, 255, 0.65); /* ë” íˆ¬ëª…í•˜ê²Œ */
            --color-text: #2C5282;
            --color-text-light: #607d8b;
            --shadow-glass: 0 8px 32px 0 rgba(31, 38, 135, 0.1);
            --border-glass: 1px solid rgba(255, 255, 255, 0.6);
        }

        * { box-sizing: border-box; margin: 0; padding: 0; font-family: 'Nanum Round Gothic', sans-serif; -webkit-tap-highlight-color: transparent; }
        
        body {
            /* ë¸”ë£¨+í™”ì´íŠ¸+í•‘í¬ê°€ ì„ì¸ ì˜¤ë¬˜í•œ ê·¸ë¼ë°ì´ì…˜ */
            background: linear-gradient(135deg, #F0F8FF 0%, #FFF0F5 50%, #E6E6FA 100%);
            color: var(--color-text);
            min-height: 100vh;
            overflow-x: hidden;
        }

        /* ğŸ“± ëª¨ë°”ì¼ ì»¨í…Œì´ë„ˆ */
        .main-container {
            width: 100%; max-width: 100vw;
            min-height: calc(100vh - 80px);
            padding: 0 20px 100px; /* ì¢Œìš° ì—¬ë°± í™•ë³´ */
            display: none;
            animation: fadeIn 0.5s ease-out;
        }
        .main-container.show { display: block; }

        /* ğŸ’ V16.0 í¬ë¦¬ìŠ¤íƒˆ í™”ì´íŠ¸ ìœ ë¦¬ ë²„íŠ¼ (ë©”ì¸ ë©”ë‰´ìš©) */
        .crystal-btn {
            width: 65px; height: 65px;
            margin: 0 auto 8px;
            border-radius: 50%;
            display: flex; align-items: center; justify-content: center;
            /* íˆ¬ëª…í•œ í™”ì´íŠ¸ ìœ ë¦¬ ì§ˆê° */
            background: linear-gradient(145deg, rgba(255,255,255,0.9), rgba(255,255,255,0.4));
            box-shadow: 
                5px 5px 15px rgba(0,0,0,0.05), 
                -5px -5px 15px rgba(255,255,255,0.8),
                inset 0 0 10px rgba(255,255,255,0.5);
            border: 1px solid rgba(255,255,255,0.8);
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            font-size: 28px;
        }
        .crystal-btn:active { transform: scale(0.95); box-shadow: inset 2px 2px 5px rgba(0,0,0,0.05); }

        /* ğŸŒ¸ ë¡œê·¸ì¸ ëª¨ë‹¬ - í•‘í¬ ë¬´ë“œ */
        .auth-modal {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.4); backdrop-filter: blur(8px);
            display: none; align-items: center; justify-content: center; z-index: 2000;
        }
        .auth-content {
            /* í•‘í¬ ê·¸ë¼ë°ì´ì…˜ ë°°ê²½ */
            background: linear-gradient(135deg, #FFF0F5 0%, #FFE4E1 100%);
            border-radius: 30px; padding: 35px; width: 85%; max-width: 360px;
            box-shadow: 0 20px 50px rgba(255, 182, 193, 0.3);
            border: 2px solid rgba(255, 255, 255, 0.8);
            text-align: center;
            animation: popUp 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }
        @keyframes popUp { from { transform: scale(0.8); opacity: 0; } to { transform: scale(1); opacity: 1; } }

        .auth-input {
            width: 100%; padding: 15px; border-radius: 15px;
            border: 1px solid rgba(255,255,255,0.5);
            background: rgba(255,255,255,0.6);
            margin-bottom: 12px; font-size: 14px;
        }
        .pink-btn {
            width: 100%; padding: 15px; border-radius: 15px; border: none;
            background: linear-gradient(45deg, #FFB6C1, #FF69B4);
            color: white; font-weight: 700; font-size: 16px;
            box-shadow: 0 4px 15px rgba(255, 105, 180, 0.3);
            cursor: pointer; margin-top: 10px;
        }

        /* ê³µí†µ í—¤ë” */
        .header-title {
            font-size: 22px; font-weight: 800; color: #2D3436;
            margin: 30px 0 5px; text-align: center;
            letter-spacing: -0.5px;
        }
        .header-desc {
            font-size: 13px; color: var(--color-text-light);
            text-align: center; margin-bottom: 30px;
        }

        /* ì¹´ë“œ ê³µí†µ ìŠ¤íƒ€ì¼ (Glass) */
        .glass-card {
            background: var(--color-glass-white);
            backdrop-filter: blur(20px);
            border-radius: 24px;
            padding: 20px;
            margin-bottom: 20px;
            border: var(--border-glass);
            box-shadow: var(--shadow-glass);
        }

        /* ğŸ“® ìŠ¤íƒ¬í”„ ê·¸ë¦¬ë“œ (ìµœì í™”) */
        .stamp-grid {
            display: grid;
            grid-template-columns: repeat(6, 1fr); /* 5x6 = 30ê°œ */
            gap: 8px; /* ê°„ê²© ì¡°ì • */
            margin: 20px auto;
            max-width: 100%;
        }
        .stamp-item {
            width: 100%; aspect-ratio: 1; /* ì •ì‚¬ê° ìœ ì§€ */
            border-radius: 50%;
            display: flex; align-items: center; justify-content: center;
            font-size: 10px; font-weight: 700;
            background: rgba(255,255,255,0.5);
            border: 1px solid rgba(0,0,0,0.05);
            color: #aaa;
            transition: all 0.3s;
        }
        .stamp-item.active {
            background: linear-gradient(135deg, #87CEEB, #4A90E2);
            color: white;
            box-shadow: 0 2px 8px rgba(74, 144, 226, 0.4);
            transform: scale(1.05);
        }

        /* ğŸ“‹ ë§ˆì´í˜ì´ì§€ í™”ì´íŠ¸ ë°•ìŠ¤ */
        .white-box-footer {
            background: white;
            border-radius: 16px;
            padding: 15px;
            margin-top: 15px;
            text-align: center;
            font-size: 12px;
            color: #555;
            line-height: 1.5;
            box-shadow: 0 2px 10px rgba(0,0,0,0.03);
        }

        /* ğŸ§­ í•˜ë‹¨ ë„¤ë¹„ê²Œì´ì…˜ (ìœ ë¦¬ë°”) */
        .bottom-nav {
            position: fixed; bottom: 20px; left: 20px; right: 20px;
            height: 65px;
            background: rgba(255, 255, 255, 0.85);
            backdrop-filter: blur(20px);
            border-radius: 35px;
            display: flex; justify-content: space-around; align-items: center;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            z-index: 999;
            padding: 0 10px;
        }
        .nav-item {
            display: flex; flex-direction: column; align-items: center;
            color: #999; font-size: 10px; text-decoration: none;
            transition: 0.3s; width: 50px;
        }
        .nav-item svg { width: 22px; height: 22px; margin-bottom: 3px; fill: currentColor; }
        .nav-item.active { color: var(--color-primary); transform: translateY(-2px); }

        /* ğŸ“ ê¸€ì“°ê¸° ëª¨ë‹¬ */
        .write-modal {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: #F7F9FB; z-index: 3000; display: none;
            flex-direction: column;
        }
        .write-header {
            padding: 15px 20px; background: white; display: flex; justify-content: space-between; align-items: center;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
        }

        /* ìœ í‹¸ë¦¬í‹° */
        .hide { display: none !important; }
        .flex-center { display: flex; align-items: center; justify-content: center; }
        
        /* í† ìŠ¤íŠ¸ ë©”ì‹œì§€ */
        .toast {
            position: fixed; top: 20px; left: 50%; transform: translateX(-50%);
            background: rgba(0,0,0,0.8); color: white; padding: 10px 20px;
            border-radius: 20px; font-size: 13px; z-index: 4000;
            animation: fadeInOut 3s forwards;
        }
        @keyframes fadeInOut { 0%{opacity:0;top:10px} 10%{opacity:1;top:20px} 90%{opacity:1;top:20px} 100%{opacity:0;top:10px} }
    </style>
</head>
<body>

    <div id="loginModal" class="auth-modal">
        <div class="auth-content">
            <h2 style="color:#FF69B4; font-size: 24px; margin-bottom: 5px;">Welcome!</h2>
            <p style="font-size: 13px; color: #888; margin-bottom: 25px;">í–…ì‚ë‹˜ì˜ í•˜ë£¨ë¥¼ ê¸°ë¡í•´ë³´ì„¸ìš”</p>
            <form onsubmit="handleLogin(event)">
                <input type="email" id="loginEmail" class="auth-input" placeholder="ì´ë©”ì¼" required>
                <input type="password" id="loginPassword" class="auth-input" placeholder="ë¹„ë°€ë²ˆí˜¸" required>
                <button type="submit" class="pink-btn">ë¡œê·¸ì¸</button>
            </form>
            <p style="margin-top:15px; font-size:12px; color:#aaa; cursor:pointer;" onclick="alert('ê°€ì… ê¸°ëŠ¥ ì¤€ë¹„ì¤‘')">íšŒì›ê°€ì…</p>
        </div>
    </div>

    <div id="letterWriteModal" class="write-modal">
        <div class="write-header">
            <span onclick="closeModal('letterWriteModal')" style="font-size: 24px; cursor:pointer;">âœ•</span>
            <span style="font-weight: 700;">ë ˆí„° ë°œí–‰</span>
            <span onclick="submitLetter()" style="color: var(--color-primary); font-weight: 700; cursor:pointer;">ë°œí–‰</span>
        </div>
        <div style="padding: 20px;">
            <select id="letterCategory" class="auth-input" style="background:white;">
                <option value="jahyu">ìíœ´ë ˆí„°</option>
                <option value="lab">ìíœ´ë©</option>
            </select>
            <input type="text" id="letterTitle" class="auth-input" placeholder="ì œëª©ì„ ì…ë ¥í•˜ì„¸ìš”" style="background:white; font-weight:bold;">
            <textarea id="letterContent" class="auth-input" style="height: 300px; background:white; resize:none;" placeholder="ë³¸ë¬¸ì„ ì‘ì„±í•˜ì„¸ìš”..."></textarea>
            <div style="border: 2px dashed #ddd; padding: 20px; text-align: center; border-radius: 15px; color: #999;">
                ğŸ“¸ ì‚¬ì§„ ì¶”ê°€ (í´ë¦­)
            </div>
        </div>
    </div>

    <div id="app"></div>

    <nav class="bottom-nav">
        <a href="#" class="nav-item active" onclick="renderTab('home')">
            <svg viewBox="0 0 24 24"><path d="M10 20v-6h4v6h5v-8h3L12 3 2 12h3v8z"/></svg>
            í™ˆ
        </a>
        <a href="#" class="nav-item" onclick="renderTab('letter')">
            <svg viewBox="0 0 24 24"><path d="M20 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 4l-8 5-8-5V6l8 5 8-5v2z"/></svg>
            ë ˆí„°
        </a>
        <a href="#" class="nav-item" onclick="renderTab('mood')">
            <svg viewBox="0 0 24 24"><path d="M11.99 2C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2zM12 20c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8zm3.5-9c.83 0 1.5-.67 1.5-1.5S16.33 8 15.5 8 14 8.67 14 9.5s.67 1.5 1.5 1.5zm-7 0c.83 0 1.5-.67 1.5-1.5S9.33 8 8.5 8 7 8.67 7 9.5 7.67 11 8.5 11zm3.5 6.5c2.33 0 4.31-1.46 5.11-3.5H6.89c.8 2.04 2.78 3.5 5.11 3.5z"/></svg>
            ë¬´ë“œ
        </a>
        <a href="#" class="nav-item" onclick="renderTab('editorTalk')">
            <svg viewBox="0 0 24 24"><path d="M20 2H4c-1.1 0-2 .9-2 2v18l4-4h14c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2z"/></svg>
            ì—ë””í„°í†¡
        </a>
        <a href="#" class="nav-item" onclick="renderTab('mypage')">
            <svg viewBox="0 0 24 24"><path d="M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"/></svg>
            ë§ˆì´
        </a>
    </nav>

    <script>
        // --- ğŸ“Š ë°ì´í„° ë° ìƒíƒœ ê´€ë¦¬ ---
        const appState = {
            currentUser: null, // ë¡œê·¸ì¸ ì‚¬ìš©ì
            stamps: 28, // í…ŒìŠ¤íŠ¸ìš© ìŠ¤íƒ¬í”„ ê°œìˆ˜
            letters: [
                { id: 1, type: 'jahyu', title: 'í‡´ì‚¬ í›„ ë²ˆì•„ì›ƒ, ì €ë§Œ ì´ëŸ°ê°€ìš”?', author: 'ì—˜ë¦¬', date: '2025.12.08' },
                { id: 2, type: 'lab', title: 'ê¸€ì“°ê¸° ë…¸í•˜ìš°: ë‚´ ë§ˆìŒì„ ë‹´ëŠ” ë²•', author: 'ê³ ì¹¼', date: '2025.12.09' }
            ],
            admins: ['happxi@jahyu.com', 'elly@jahyu.com', 'gokal@jahyu.com', 'sunny@jahyu.com', 'yudan@jahyu.com']
        };

        const dom = {
            app: document.getElementById('app'),
            modal: {
                login: document.getElementById('loginModal'),
                letter: document.getElementById('letterWriteModal')
            }
        };

        // --- ğŸš€ ì´ˆê¸°í™” ---
        function init() {
            // ìë™ ë¡œê·¸ì¸ ì²´í¬ (ì˜ˆì‹œ)
            const savedUser = localStorage.getItem('user');
            if (savedUser) {
                appState.currentUser = JSON.parse(savedUser);
                renderTab('home');
            } else {
                renderTab('home'); // ë¹„ë¡œê·¸ì¸ ìƒíƒœë¡œ í™ˆ ë Œë”ë§
                // setTimeout(() => dom.modal.login.style.display = 'flex', 500); // ìë™ ë¡œê·¸ì¸ íŒì—… (ì„ íƒ)
            }
        }

        // --- ğŸ“‘ íƒ­ ë Œë”ë§ ì‹œìŠ¤í…œ ---
        function renderTab(tabName) {
            updateNav(tabName);
            dom.app.innerHTML = ''; // ì´ˆê¸°í™”
            
            const container = document.createElement('div');
            container.className = 'main-container show';

            switch(tabName) {
                case 'home': container.innerHTML = getHomeHTML(); break;
                case 'letter': container.innerHTML = getLetterHTML(); break;
                case 'mood': 
                    // ë¬´ë“œ íƒ­ì€ ë¡œê·¸ì¸ í•„ìš”
                    if(!checkLogin()) return;
                    // ì‹¤ì œ ë¬´ë“œ í˜ì´ì§€ (ì—¬ê¸°ì„œëŠ” ê°„ë‹¨íˆ ë„¤ë¹„ê²Œì´ì…˜ë§Œ ì´ë™ ì²˜ë¦¬)
                    alert("ì˜¤ëŠ˜ì˜ ë¬´ë“œ íƒ­ìœ¼ë¡œ ì´ë™í•©ë‹ˆë‹¤. (êµ¬í˜„ëœ í˜ì´ì§€)"); 
                    container.innerHTML = getHomeHTML(); // ì„ì‹œ
                    break;
                case 'editorTalk': container.innerHTML = getEditorTalkHTML(); break;
                case 'mypage': 
                    if(!checkLogin()) return;
                    container.innerHTML = getMyPageHTML(); 
                    break;
            }
            dom.app.appendChild(container);
        }

        // --- ğŸ–¼ï¸ í˜ì´ì§€ë³„ HTML ìƒì„± í•¨ìˆ˜ ---

        function getHomeHTML() {
            return `
                <h1 class="header-title">í–…ì‚ë‹˜ ì˜¤ëŠ˜ë„ í–‰ë³µí•˜ì„¸ìš”!</h1>
                <p class="header-desc">ë©”ë§ˆë¥¸ ì¼ìƒì— íœ´ì‹ í•œ ë°©ìš¸! ğŸ’§</p>

                <div class="glass-card" style="background: linear-gradient(135deg, #E0F7FA 0%, #E1BEE7 100%); border:none;">
                    <h3 style="font-size:18px; font-weight:700; color:#444;">ë‚˜ì˜ íë§ ìœ í˜•ì€?</h3>
                    <p style="font-size:12px; color:#666; margin-top:5px;">ë‚˜ì—ê²Œ ë”± ë§ëŠ” íœ´ì‹ì„ ì°¾ì•„ë³´ì! ğŸ”®</p>
                    <button onclick="window.open('https://index-html-zak5.vercel.app/')" style="margin-top:15px; padding:8px 20px; background:white; border-radius:20px; border:none; font-weight:700; color:#555; box-shadow:0 4px 10px rgba(0,0,0,0.05);">í…ŒìŠ¤íŠ¸ í•˜ê¸° ğŸ‘‰</button>
                </div>

                <div style="display: flex; justify-content: space-between; margin-top: 30px; text-align: center;">
                    
                    <div onclick="window.open('https://maily.so/happci/')" style="cursor:pointer;">
                        <div class="crystal-btn">ğŸ’Œ</div>
                        <span style="font-size:11px; color:#666;">ë ˆí„° ì½ê¸°</span>
                    </div>

                    <div onclick="window.open('https://index-html-zak5.vercel.app/')" style="cursor:pointer;">
                        <div class="crystal-btn">ğŸ”®</div>
                        <span style="font-size:11px; color:#666;">íë§ í…ŒìŠ¤íŠ¸</span>
                    </div>

                    <div onclick="renderTab('mood')" style="cursor:pointer;">
                        <div class="crystal-btn">â˜ï¸</div>
                        <span style="font-size:11px; color:#666;">ì˜¤ëŠ˜ì˜ ë¬´ë“œ</span>
                    </div>

                    <div onclick="window.open('http://pf.kakao.com/_Jfjxgn/111753149')" style="cursor:pointer;">
                        <div class="crystal-btn">ğŸ“–</div>
                        <span style="font-size:11px; color:#666;">ë¬¸ì¥ ìˆ˜ì§‘</span>
                    </div>

                    <div onclick="window.open('http://pf.kakao.com/_Jfjxgn/chat')" style="cursor:pointer;">
                        <div class="crystal-btn">ğŸ’¬</div>
                        <span style="font-size:11px; color:#666;">1:1 ì±„íŒ…</span>
                    </div>

                </div>
            `;
        }

        function getLetterHTML() {
            const isAdmin = appState.currentUser && appState.admins.includes(appState.currentUser.id);
            
            let listHTML = appState.letters.map(l => `
                <div class="glass-card" style="padding:15px;">
                    <span style="font-size:10px; padding:3px 8px; border-radius:10px; background:${l.type === 'jahyu' ? '#E6E6FA' : '#E0F7FA'}; color:#555; font-weight:bold;">
                        ${l.type === 'jahyu' ? 'ìíœ´ë ˆí„°' : 'ìíœ´ë©'}
                    </span>
                    <h3 style="font-size:16px; margin:8px 0 4px;">${l.title}</h3>
                    <p style="font-size:12px; color:#888;">${l.author} Â· ${l.date}</p>
                </div>
            `).join('');

            return `
                <h2 class="header-title">ë ˆí„° ì•„ì¹´ì´ë¸Œ</h2>
                <p class="header-desc">ìíœ´ë ˆí„°ì™€ ìíœ´ë©ì„ ì£¼ì œë³„ë¡œ í•œ ëˆˆì—!</p>
                
                <div style="display:flex; gap:10px; margin-bottom:20px;">
                    <button style="flex:1; padding:10px; border-radius:15px; border:1px solid #ddd; background:white; font-weight:bold; color:#4A90E2;">ì „ì²´</button>
                    <button style="flex:1; padding:10px; border-radius:15px; border:1px solid #ddd; background:rgba(255,255,255,0.5); color:#666;">ìíœ´ë ˆí„°</button>
                    <button style="flex:1; padding:10px; border-radius:15px; border:1px solid #ddd; background:rgba(255,255,255,0.5); color:#666;">ìíœ´ë©</button>
                </div>

                ${isAdmin ? `<button onclick="openLetterModal()" style="width:100%; padding:12px; background:#4A90E2; color:white; border-radius:15px; border:none; margin-bottom:20px; font-weight:bold;">âœï¸ ê´€ë¦¬ì ê¸€ì“°ê¸°</button>` : ''}

                <div class="letter-list">${listHTML}</div>
            `;
        }

        function getEditorTalkHTML() {
            return `
                <h2 class="header-title">ì—ë””í„° í†¡</h2>
                <p class="header-desc">ì—ë””í„°ì˜ ì¼ìƒì„ ë” ê°€ê¹Œì´ì—ì„œ ë§Œë‚˜ë³´ì„¸ìš”!</p>
                <div class="glass-card">
                    <div style="display:flex; align-items:center; margin-bottom:10px;">
                        <div style="width:30px; height:30px; background:#ddd; border-radius:50%; margin-right:10px;"></div>
                        <span style="font-weight:bold;">ì—˜ë¦¬</span>
                    </div>
                    <p style="font-size:14px; line-height:1.5;">ì˜¤ëŠ˜ ë‚ ì”¨ê°€ ë„ˆë¬´ ì¢‹ë„¤ìš”! ë‹¤ë“¤ ì‚°ì±… í•˜ì…¨ë‚˜ìš”? ğŸŒ¿</p>
                </div>
            `;
        }

        function getMyPageHTML() {
            const user = appState.currentUser;
            // ìŠ¤íƒ¬í”„ ê·¸ë¦¬ë“œ ìƒì„± (30ê°œ ê³ ì •)
            let stampHTML = '<div class="stamp-grid">';
            for (let i = 1; i <= 30; i++) {
                const active = i <= appState.stamps ? 'active' : '';
                stampHTML += `<div class="stamp-item ${active}">${i}</div>`;
            }
            stampHTML += '</div>';

            return `
                <h2 class="header-title">My Page</h2>
                
                <div class="glass-card" style="display:flex; align-items:center; background:white;">
                    <div style="width:50px; height:50px; background:#FFB6C1; border-radius:50%; display:flex; align-items:center; justify-content:center; color:white; font-weight:bold; font-size:20px; margin-right:15px;">
                        ${user.name.charAt(0)}
                    </div>
                    <div>
                        <h3 style="font-size:18px;">${user.name}ë‹˜</h3>
                        <p style="font-size:12px; color:#888;">${user.id}</p>
                    </div>
                </div>

                <div class="glass-card" style="padding:0;">
                    ${['ë‚´ê°€ ì“´ ê¸€', 'ë‚˜ì˜ ëŒ“ê¸€', 'ì¢‹ì•„ìš”í•œ ê¸€', 'ë¶ë§ˆí¬í•œ ê¸€'].map(menu => `
                        <div style="padding:15px; border-bottom:1px solid #eee; display:flex; justify-content:space-between; align-items:center;">
                            <span style="font-size:14px; color:#444;">${menu}</span>
                            <span style="color:#ccc;">â€º</span>
                        </div>
                    `).join('')}
                </div>

                <div class="glass-card">
                    <h3 style="font-size:16px; font-weight:bold; color:#4A90E2; margin-bottom:10px;">ìíœ´ìŠ¤íƒ¬í”„ í˜„í™© (${appState.stamps}ê°œ)</h3>
                    ${stampHTML}
                    
                    <div class="white-box-footer">
                        ì˜¤ëŠ˜ì˜ ë¬´ë“œë¥¼ ê¸°ë¡í•´ë³´ì„¸ìš”!<br>
                        *30ê°œë¥¼ ëª¨ì€ ìŠ¤íƒ¬í”„í™”ë©´ì„ ìº¡ì³í•´ì„œ êµ¬ë… ì¤‘ì¸ ì´ë©”ì¼ê³¼ í•¨ê»˜ ì¹´í†¡ì±„ë„ë¡œ ë³´ë‚´ì£¼ì„¸ìš”! ì–´ëŠë‚  ìŠ¤íì…œë ˆí„°ê°€ ë„ì°©í• ì§€ë„ ëª°ë¼ìš”!â¤ï¸
                    </div>
                </div>

                <button onclick="logout()" style="width:100%; padding:15px; margin-top:20px; border:none; background:none; color:#FF6B6B; font-weight:bold;">ë¡œê·¸ì•„ì›ƒ</button>
            `;
        }

        // --- âš™ï¸ ê¸°ëŠ¥ ë¡œì§ ---

        function checkLogin() {
            if (!appState.currentUser) {
                dom.modal.login.style.display = 'flex';
                return false;
            }
            return true;
        }

        function handleLogin(e) {
            e.preventDefault();
            const email = document.getElementById('loginEmail').value;
            // ì„ì‹œ ë¡œê·¸ì¸ ë¡œì§
            appState.currentUser = { 
                id: email, 
                name: email.includes('happxi') ? 'í–…ì”¨' : 'í–…ì‚' 
            };
            localStorage.setItem('user', JSON.stringify(appState.currentUser));
            dom.modal.login.style.display = 'none';
            renderTab('home');
        }

        function logout() {
            appState.currentUser = null;
            localStorage.removeItem('user');
            renderTab('home');
        }

        function updateNav(tabName) {
            document.querySelectorAll('.nav-item').forEach(el => el.classList.remove('active'));
            // ê°„ë‹¨í•œ ë§¤í•‘ (ì‹¤ì œë¡œëŠ” data-target ë“±ì„ í™œìš©)
            // ì—¬ê¸°ì„œëŠ” ìƒëµí•˜ê³  íƒ­ ì „í™˜ ì‹œ ìŠ¤íƒ€ì¼ë§Œ ì´ˆê¸°í™”
        }

        // --- ê´€ë¦¬ì ë ˆí„° ë°œí–‰ ---
        function openLetterModal() {
            dom.modal.letter.style.display = 'flex';
        }
        function closeModal(id) {
            document.getElementById(id).style.display = 'none';
        }
        function submitLetter() {
            const title = document.getElementById('letterTitle').value;
            const cat = document.getElementById('letterCategory').value;
            
            if(!title) return alert('ì œëª©ì„ ì…ë ¥í•´ì£¼ì„¸ìš”');
            
            // ë°ì´í„° ì¶”ê°€
            appState.letters.unshift({
                id: Date.now(),
                type: cat,
                title: title,
                author: appState.currentUser.name,
                date: new Date().toLocaleDateString()
            });
            
            closeModal('letterWriteModal');
            renderTab('letter'); // ëª©ë¡ ê°±ì‹ 
            showToast('ë ˆí„°ê°€ ë°œí–‰ë˜ì—ˆìŠµë‹ˆë‹¤! ğŸ‰');
        }

        function showToast(msg) {
            const div = document.createElement('div');
            div.className = 'toast';
            div.innerText = msg;
            document.body.appendChild(div);
            setTimeout(() => div.remove(), 3000);
        }

        // ì•± ì‹œì‘
        init();
    </script>
</body>
</html>
