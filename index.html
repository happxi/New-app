<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ë©”ë§ˆë¥¸ ì¼ìƒì— íœ´ì‹ í•œ ë°©ìš¸, ìíœ´ë ˆí„°</title>
    
    <script src="https://cdn.tailwindcss.com"></script>
    
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500;700;900&display=swap" rel="stylesheet">
    <script src="https://unpkg.com/heroicons@2.1.3/24/outline/index.js"></script>
    <script src="https://unpkg.com/heroicons@2.1.3/24/solid/index.js"></script>

    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'primary-blue': '#73A3E0',
                        'primary-light': '#B6D3FF',
                        'soft-bg': '#F7F9FB',
                        'glass-white': 'rgba(255, 255, 255, 0.95)',
                        'new-pink': '#FFC0CB',
                        'text-main': '#2D3436',
                        'text-sub': '#636E72',
                        'kakao': '#FEE500',
                    },
                    boxShadow: {
                        'soft': '0 8px 30px rgba(0, 0, 0, 0.1)',
                    }
                }
            }
        }
    </script>

    <style>
        body {
            font-family: 'Noto Sans KR', sans-serif;
            background-color: #f0f2f5;
            -webkit-font-smoothing: antialiased;
            color: #2D3436;
        }
        .app-container {
            max-width: 480px;
            margin: 0 auto;
            background-color: #F7F9FB;
            min-height: 100vh;
            position: relative;
            box-shadow: 0 0 30px rgba(0,0,0,0.05);
            padding-bottom: 70px; /* íƒ­ë°” ê³ ì • ê³µê°„ */
        }
        
        /* V9.5: Floating & Glass Header */
        .glass-nav {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(12px);
            -webkit-backdrop-filter: blur(12px);
            border-bottom: 1px solid rgba(0,0,0,0.05);
        }
        
        /* V9.5: Fixed Bottom Nav */
        .bottom-nav {
            position: fixed; 
            bottom: 0;
            left: 50%; /* ì¤‘ì•™ ì •ë ¬ì„ ìœ„í•œ ì„¤ì • */
            transform: translateX(-50%); /* ì¤‘ì•™ ì •ë ¬ì„ ìœ„í•œ ì„¤ì • */
            max-width: 480px;
            width: 100%;
            z-index: 100;
            height: 70px;
            box-shadow: 0 0 20px rgba(0, 0, 0, 0.08);
            padding-top: 5px; /* ì•„ì´ì½˜-í…ìŠ¤íŠ¸ ì •ë ¬ ë¯¸ì„¸ ì¡°ì • */
        }

        /* V9.5: Tab Item Center Alignment */
        .tab-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            line-height: 1.2;
            padding-bottom: 4px; /* íƒ­ë°” ë†’ì´ ë‚´ì—ì„œ ì¤‘ì•™ ì •ë ¬ */
            transition: color 0.2s;
        }

        .active-tab-icon { color: #73A3E0; }

        /* V9.5: Masonry Layout for Moment */
        .masonry-grid {
            column-count: 2;
            column-gap: 12px;
        }
        .masonry-item {
            display: inline-block;
            width: 100%;
            margin-bottom: 12px;
            break-inside: avoid;
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 4px 10px rgba(0,0,0,0.05);
        }
        
        /* ê¸°íƒ€ ìŠ¤íƒ€ì¼ ìœ ì§€ */
        .fade-in { animation: fadeIn 0.4s cubic-bezier(0.4, 0, 0.2, 1); }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

        .hide { display: none !important; }
    </style>
</head>
<body>

<div class="app-container">
    
    <header class="sticky top-0 z-50 glass-nav h-16 flex items-center justify-between px-4">
        <div class="flex items-center">
            <button id="backBtn" onclick="goBack()" class="mr-3 p-2 rounded-full hover:bg-gray-100 transition hide">
                <svg class="w-6 h-6 text-gray-600" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"/></svg>
            </button>
            <h1 class="text-xl font-extrabold text-primary-blue tracking-tight cursor-pointer" onclick="navigateTo('home')">ìíœ´ë ˆí„°</h1>
        </div>
        
        <div class="flex items-center gap-3">
            <button id="adminWriteBtn" onclick="showWriteModal()" class="hide p-2 bg-primary-blue rounded-full text-white shadow-md hover:bg-blue-600 transition">
                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414l2.828 2.828m-2.828-2.828l3.536 3.536M16 4l4 4m-4 4L19 9 9 19H5v-4l10-10z"/></svg>
            </button>
            <button onclick="toggleAuth()" class="text-sm font-medium text-text-sub hover:text-primary-blue transition" id="authBtnText">ë¡œê·¸ì•„ì›ƒ</button>
        </div>
    </header>

    <main class="px-4 py-4">
        
        <section id="homePage" class="fade-in">
            <div class="mb-6 mt-2">
                <h2 id="greetingTitle" class="text-2xl font-bold text-text-main leading-tight">í–…ì‚ë‹˜ ì˜¤ëŠ˜ë„ í–‰ë³µí•˜ì„¸ìš”!</h2>
                <p id="greetingSub" class="text-sm text-text-sub mt-1">ë©”ë§ˆë¥¸ ì¼ìƒì— íœ´ì‹ í•œ ë°©ìš¸, ìíœ´ë ˆí„°</p>
            </div>

            <div class="relative w-full h-40 rounded-2xl overflow-hidden shadow-soft mb-6 group cursor-pointer active:scale-[0.99] transition-transform" onclick="window.open('https://index-html-zak5.vercel.app/', '_blank')">
                <div class="absolute inset-0 bg-gradient-to-r from-primary-light to-new-pink/50 transition duration-300 group-hover:scale-[1.01]"></div>
                <div class="absolute inset-0 flex flex-col justify-center items-start p-6">
                    <span class="bg-white/70 backdrop-blur-sm text-red-500 text-[10px] font-bold px-2 py-0.5 rounded-full mb-2">HOT TREND</span>
                    <h3 class="text-xl font-bold text-text-main">ë‚˜ì˜ íë§ ìœ í˜•ì€?</h3>
                    <p class="text-xs text-text-main mt-1 opacity-90">ì§€ê¸ˆ ë°”ë¡œ í…ŒìŠ¤íŠ¸í•˜ê³  ë§ì¶¤ ë ˆí„° ë°›ê¸° ğŸ‘‰</p>
                </div>
                <div class="absolute bottom-4 right-4 text-4xl">ğŸŒ¿</div>
            </div>

            <div class="relative w-full p-5 rounded-2xl shadow-soft mb-8 bg-white/70 border border-gray-100 cursor-pointer group active:scale-[0.99] transition-transform" onclick="navigateTo('newsletter')">
                <div class="flex justify-between items-center">
                    <div>
                        <h4 class="text-lg font-bold text-primary-blue">ì „ì²´ ë ˆí„° ì•„ì¹´ì´ë¸Œ</h4>
                        <p class="text-xs text-text-sub mt-1">ìíœ´ë ˆí„°ì™€ ìíœ´ë©ì„ í•œ ëˆˆì— ëª¨ì•„ë³´ì„¸ìš”.</p>
                    </div>
                    <div class="w-10 h-10 rounded-full bg-primary-light/50 flex items-center justify-center text-primary-blue group-hover:rotate-12 transition">
                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"/></svg>
                    </div>
                </div>
            </div>

            <div class="flex justify-around mb-8 p-3">
                <div class="flex flex-col items-center gap-2 group cursor-pointer">
                    <div class="w-16 h-16 rounded-full bg-pink-100 flex items-center justify-center shadow-lg group-active:scale-[0.85] transition-all duration-300 ease-in-out" onclick="navigateTo('newsletter')">
                         <svg class="w-7 h-7 text-pink-700" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" d="M3 8l7.892 5.263A2 2 0 0012 14.242h-.001a2 2 0 001.108-.344L21 8m-8 7l-7 7m7-7l7 7"/></svg>
                    </div>
                    <span class="text-xs font-medium text-text-main">ë ˆí„° ë³´ê¸°</span>
                </div>
                <a href="#" class="flex flex-col items-center gap-2 group">
                    <div class="w-16 h-16 rounded-full bg-indigo-100 flex items-center justify-center shadow-lg group-active:scale-[0.85] transition-all duration-300 ease-in-out">
                        <svg class="w-7 h-7 text-indigo-700" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" d="M16 4v12l-4-2-4 2V4M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"/></svg>
                    </div>
                    <span class="text-xs font-medium text-text-main">ë¬¸ì¥ ìˆ˜ì§‘</span>
                </a>
                <a href="http://pf.kakao.com/_Jfjxgn" target="_blank" class="flex flex-col items-center gap-2 group">
                    <div class="w-16 h-16 rounded-full bg-kakao flex items-center justify-center shadow-lg group-active:scale-[0.85] transition-all duration-300 ease-in-out">
                        <svg class="w-7 h-7 text-yellow-900" fill="currentColor" viewBox="0 0 24 24"><path d="M12 3c-4.97 0-9 3.185-9 7.115 0 2.557 1.707 4.8 4.27 6.054-.188.702-.682 2.545-.78 2.94-.123.49.178.483.376.351.155-.103 2.466-1.675 3.464-2.353.541.08 1.1.123 1.67.123 4.97 0 9-3.186 9-7.115C21 6.185 16.97 3 12 3z"/></svg>
                    </div>
                    <span class="text-xs font-medium text-text-main">ì¹´í†¡ ì¶”ê°€</span>
                </a>
            </div>

            <div class="h-16"></div>
        </section>

        <section id="newsletterPage" class="hide fade-in">
            <div class="sticky top-16 bg-soft-bg z-30 pb-3 pt-1">
                <h2 class="text-2xl font-bold text-text-main mb-1">ì§€ê¸ˆ ê¼­ í•„ìš”í•œ<br>ìœ„ë¡œë¥¼ ë°›ì•„ë³´ì„¸ìš”!</h2>
                <p class="text-xs text-text-sub mb-4">ìíœ´ë ˆí„°ì™€ ìíœ´ë©ì„ ì£¼ì œë³„ë¡œ í•œ ëˆˆì—!</p>
                
                <div class="flex gap-2">
                    <button class="filter-btn px-4 py-1.5 rounded-full text-xs font-bold bg-primary-blue text-white transition shadow-sm" data-filter="all" onclick="filterLetters('all')">ì „ì²´</button>
                    <button class="filter-btn px-4 py-1.5 rounded-full text-xs font-bold bg-white text-text-sub border border-gray-200 transition" data-filter="letter" onclick="filterLetters('letter')">ìíœ´ë ˆí„°</button>
                    <button class="filter-btn px-4 py-1.5 rounded-full text-xs font-bold bg-white text-text-sub border border-gray-200 transition" data-filter="lab" onclick="filterLetters('lab')">ìíœ´ë©</button>
                </div>
            </div>

            <div id="letterListContainer" class="mt-4 space-y-4 pb-20">
                </div>
        </section>

        <section id="editorTalkPage" class="hide fade-in">
            <div class="mb-4">
                <h2 class="text-2xl font-bold text-text-main">ì—ë””í„° í†¡ ğŸ’¬</h2>
                <p class="text-sm text-text-sub">ì—ë””í„°ë“¤ì˜ ì¼ìƒì„ ë§Œë‚˜ë³´ì„¸ìš”!</p>
            </div>
            <div id="editorTalkListContainer" class="space-y-4 pb-20"></div>
        </section>

        <section id="momentPage" class="hide fade-in">
            <div class="mb-4 flex justify-between items-center">
                <div>
                    <h2 class="text-2xl font-bold text-text-main">ëª¨ë¨¼íŠ¸ âœ¨</h2>
                    <p class="text-sm text-text-sub">í–…ì‚ë‹˜ì˜ ì¼ìƒì´ ê¶ê¸ˆí•´ìš”!</p>
                </div>
                <button onclick="checkAuthAndWriteMoment()" class="p-2 bg-new-pink rounded-full text-white shadow-md hover:bg-red-500 transition active:scale-90">
                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"/></svg>
                </button>
            </div>
            <div id="momentListContainer" class="masonry-grid pb-20"></div>
        </section>

        <section id="myPage" class="hide fade-in">
            <div id="myProfileArea">
                </div>

            <div class="bg-white rounded-xl shadow-soft overflow-hidden mt-6">
                <button class="w-full text-left p-4 border-b border-gray-100 hover:bg-gray-50 flex justify-between items-center" onclick="alert('ì¢‹ì•„ìš”í•œ ê¸€ ëª©ë¡ ë³´ê¸°')">
                    <span class="font-medium text-text-main">â¤ï¸ ì¢‹ì•„ìš”í•œ ê¸€</span><span class="text-xs text-text-sub">3ê±´</span>
                </button>
                <button class="w-full text-left p-4 border-b border-gray-100 hover:bg-gray-50 flex justify-between items-center" onclick="alert('ë‚´ê°€ ì“´ ê¸€/ëª¨ë¨¼íŠ¸ ë³´ê¸°')">
                    <span class="font-medium text-text-main">ğŸ“ ë‚´ê°€ ì“´ ê¸€ / ëª¨ë¨¼íŠ¸</span><span class="text-xs text-text-sub">5ê±´</span>
                </button>
                <button class="w-full text-left p-4 border-b border-gray-100 hover:bg-gray-50 flex justify-between items-center" onclick="alert('ëŒ“ê¸€ ëª¨ì•„ë³´ê¸°')">
                    <span class="font-medium text-text-main">ğŸ’¬ ëŒ“ê¸€ ëª¨ì•„ë³´ê¸°</span><span class="text-xs text-text-sub">12ê±´</span>
                </button>
                <button class="w-full text-left p-4 hover:bg-gray-50 flex justify-between items-center" onclick="alert('ë‚˜ë§Œì˜ íë§ ìŠ¤íƒ¬í”„ í™•ì¸')">
                    <span class="font-medium text-text-main">â­ï¸ íë§ ìŠ¤íƒ¬í”„</span><span class="text-xs text-primary-blue font-bold">VIP</span>
                </button>
            </div>

            <div class="h-20"></div>
        </section>

        <section id="detailPage" class="hide fade-in bg-white min-h-screen absolute top-0 left-0 w-full z-40 p-4 pt-16">
            <div id="detailContentArea"></div>
        </section>

    </main>

    <nav class="bottom-nav glass-nav flex justify-around items-center px-2">
        <button class="tab-item w-full h-full text-gray-400" onclick="navigateTo('home')" id="nav-home">
            <svg id="icon-home" class="w-6 h-6" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="m2.25 12 8.954-8.955c.44-.439 1.15-.439 1.59 0L21.75 12M4.5 9.75v10.125c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V9.75M8.25 21.75h7.5"/></svg>
            <span class="text-[10px] font-medium mt-0.5">í™ˆ</span>
        </button>
        <button class="tab-item w-full h-full text-gray-400" onclick="navigateTo('newsletter')" id="nav-newsletter">
             <svg id="icon-newsletter" class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M21.75 6.75v10.5a2.25 2.25 0 0 1-2.25 2.25h-15a2.25 2.25 0 0 1-2.25-2.25V6.75m19.5 0A2.25 2.25 0 0 0 19.5 4.5h-15a2.25 2.25 0 0 0-2.25 2.25m19.5 0v.243a2.25 2.25 0 0 1-1.105 1.984l-11.7 6.002a2.25 2.25 0 0 1-2.191 0-11.7 6.002 0 0 1-11.7-6.002v-.243"/></svg>
            <span class="text-[10px] font-medium mt-0.5">ë ˆí„°</span>
        </button>
        <button class="tab-item w-full h-full text-gray-400" onclick="navigateTo('editorTalk')" id="nav-editorTalk">
            <svg id="icon-editorTalk" class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M8.625 12a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Zm0 0H7.5m-.75 0c0 5.25 4.25 9.75 9.75 9.75s9.75-4.5 9.75-9.75S17.25 2.25 12 2.25 2.25 6.75 2.25 12Zm7.5 0h.008v.008H9.75V12Zm3.75 0h.008v.008h-.008V12Zm3.75 0h.008v.008h-.008V12Z"/></svg>
            <span class="text-[10px] font-medium mt-0.5">ì—ë””í„°í†¡</span>
        </button>
        <button class="tab-item w-full h-full text-gray-400" onclick="navigateTo('moment')" id="nav-moment">
            <svg id="icon-moment" class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M12 18.75a6 6 0 0 0 6-6M12 15a3 3 0 1 0 0-6 3 3 0 0 0 0 6Z"/><path stroke-linecap="round" stroke-linejoin="round" d="M12 4.5a7.5 7.5 0 1 0 7.5 7.5A7.5 7.5 0 0 0 12 4.5ZM12 4.5V3m0 18v-1.5m7.5-7.5h1.5M3 12h1.5m10.875 3.375-.929-.929m-11.782.929 1.06-1.06m0-7.531 1.06 1.06m9.281 0-.929-.929"/></svg>
            <span class="text-[10px] font-medium mt-0.5">ëª¨ë¨¼íŠ¸</span>
        </button>
        <button class="tab-item w-full h-full text-gray-400" onclick="navigateTo('myPage')" id="nav-myPage">
            <svg id="icon-myPage" class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 6a3.75 3.75 0 1 1-7.5 0 3.75 3.75 0 0 1 7.5 0ZM4.5 20.25a.75.75 0 0 1 .75-.75h14.5a.75.75 0 0 1 .75.75v.75c0 .414-.336.75-.75.75H5.25a.75.75 0 0 1-.75-.75v-.75Z"/></svg>
            <span class="text-[10px] font-medium mt-0.5">ë§ˆì´</span>
        </button>
    </nav>

    <div id="authModal" class="modal bg-black/60 backdrop-blur-sm" onclick="closeModal(event, 'authModal')">
        <div class="modal-content text-center">
            <div class="w-12 h-12 bg-primary-blue/20 rounded-full flex items-center justify-center mx-auto mb-3">
                <svg class="w-6 h-6 text-primary-blue" fill="currentColor" viewBox="0 0 20 20"><path d="M2.003 5.884L10 9.882l7.997-3.998A2 2 0 0016 4H4a2 2 0 00-1.997 1.884z"/><path d="M18 8.118l-8 4-8-4V14a2 2 0 002 2h12a2 2 0 002-2V8.118z"/></svg>
            </div>
            <h3 class="text-xl font-bold text-primary-blue">í–…ì‚ë‹˜ ë°˜ê°‘ìŠµë‹ˆë‹¤!</h3>
            <p class="text-xs text-text-sub mt-1 mb-6">ë‹¹ì‹ ì˜ íë§ì„ ìœ„í•œ, ìíœ´ë ˆí„°</p>
            
            <form id="loginForm" class="space-y-3" onsubmit="event.preventDefault(); handleLogin();">
                <input type="email" id="authEmail" value="happxi@jahyu.com" placeholder="ì´ë©”ì¼" class="w-full p-3 bg-gray-50 border border-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-primary-blue transition">
                <input type="password" id="authPassword" value="123456" placeholder="ë¹„ë°€ë²ˆí˜¸" class="w-full p-3 bg-gray-50 border border-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-primary-blue transition">
                <button type="submit" class="w-full bg-new-pink text-white py-3 rounded-xl font-bold shadow-md hover:bg-red-500 transition transform active:scale-95">ë¡œê·¸ì¸</button>
            </form>
        </div>
    </div>
    
    <div id="writeModal" class="modal bg-black/60 backdrop-blur-sm" onclick="closeModal(event, 'writeModal')">
        <div class="modal-content">
            <h3 id="writeModalTitle" class="text-xl font-bold text-primary-blue mb-4">ìƒˆ ê¸€ ì‘ì„±</h3>
            <form class="space-y-3">
                <select id="postType" class="w-full p-3 bg-gray-50 border rounded-xl" onchange="updateModalForMoment(this.value)">
                    <option value="letter">ìíœ´ë ˆí„°/ìíœ´ë© (ê´€ë¦¬ì ì „ìš©)</option>
                    <option value="moment">ëª¨ë¨¼íŠ¸ (ëª¨ë‘ ì‘ì„± ê°€ëŠ¥)</option>
                </select>
                <input type="text" id="postTitle" placeholder="ì œëª©" class="w-full p-3 bg-gray-50 border rounded-xl focus:ring-2 focus:ring-primary-blue">
                <textarea id="postContent" placeholder="ë‚´ìš©ì„ ì…ë ¥í•˜ì„¸ìš”" rows="6" class="w-full p-3 bg-gray-50 border rounded-xl focus:ring-2 focus:ring-primary-blue"></textarea>
                <button type="button" onclick="submitPost()" class="w-full bg-new-pink text-white py-3 rounded-xl font-bold hover:bg-red-500 transition">ì‘ì„± ì™„ë£Œ</button>
            </form>
        </div>
    </div>

</div> <script>
    // --- Data & State ---
    const ADMINS = ['happxi@jahyu.com', 'hr@mail.com'];
    let currentUser = null;
    let currentTab = 'home';
    let data = {
        posts: [
            { id: 1, type: 'letter', category: 'letter', title: 'í‡´ì‚¬ í›„ ë²ˆì•„ì›ƒ, ì €ë§Œ ì´ëŸ°ê°€ìš”?', author: 'ì—˜ë¦¬', date: '2025.12.08', content: 'í‡´ì‚¬ í›„ì—ë„ ì‰¬ì§€ ëª»í•˜ëŠ” ë‹¹ì‹ ì—ê²Œ...', isNew: true },
            { id: 2, type: 'letter', category: 'lab', title: 'ê¸€ì“°ê¸° ë…¸í•˜ìš°: ë‚´ ë§ˆìŒì„ ë‹´ëŠ” ë²•', author: 'ê³ ì¹¼', date: '2025.12.05', content: 'ê¸€ì“°ê¸° íŒ€ ê³µìœ ...', isNew: true },
            { id: 3, type: 'editorTalk', title: 'ì¼ì£¼ì¼ ì˜ ë²„í‹°ì…¨ë‚˜ìš”?', author: 'ì—˜ë¦¬', date: '2025.12.08', content: 'ì£¼ë§ì—” ì•„ë¬´ ìƒê° ì—†ì´ ì‰¬ì–´ì•¼ í•´ìš”!', isNew: true },
            // V9.5: ëª¨ë¨¼íŠ¸ ë†’ì´ ë‹¤ì–‘í™”ë¥¼ ìœ„í•œ ë”ë¯¸ ë°ì´í„° ì¶”ê°€
            { id: 4, type: 'moment', title: 'í‡´ê·¼ê¸¸ í•˜ëŠ˜ì´ ì˜ˆë»ì„œ', author: 'í–…ì”¨', date: '2025.12.08', imgColor: 'bg-blue-200', height: 'h-64' },
            { id: 5, type: 'moment', title: 'ì»¤í”¼ í•œì”ì˜ ì—¬ìœ ', author: 'ê³ ì¹¼', date: '2025.12.07', imgColor: 'bg-yellow-200', height: 'h-40' },
            { id: 6, type: 'moment', title: 'ì½ê³  ìˆëŠ” ì±…', author: 'ë°©ë¬¸ì', date: '2025.12.06', imgColor: 'bg-pink-200', height: 'h-52' },
            { id: 7, type: 'moment', title: 'ì ì‹¬ ë©”ë‰´ ìë‘', author: 'ì—˜ë¦¬', date: '2025.12.05', imgColor: 'bg-green-200', height: 'h-48' },
        ]
    };

    // --- Init ---
    document.addEventListener('DOMContentLoaded', () => {
        navigateTo('home');
        // Vercel í…ŒìŠ¤íŠ¸ í™˜ê²½ì—ì„œ ìë™ ë¡œê·¸ì¸ ì‹œë®¬ë ˆì´ì…˜
        currentUser = { name: 'í–…ì‚', email: 'happxi@jahyu.com', isAdmin: true }; 
        updateUI();
    });

    // --- Navigation & UX ---
    
    // V9.5: ì•„ì´ì½˜ SVG ê²½ë¡œ ì—…ë°ì´íŠ¸ ë° Active State ì„¤ì •
    function updateIconState(id, isActive) {
        const btn = document.getElementById(id);
        const svg = btn.querySelector('svg');
        if (svg) {
            // Outline(stroke)ê³¼ Solid(fill) ìƒíƒœ ì „í™˜ ì‹œë®¬ë ˆì´ì…˜
            if (isActive) {
                 btn.classList.add('active-tab-icon');
            } else {
                 btn.classList.remove('active-tab-icon');
            }
        }
    }
    
    function navigateTo(pageId, postId = null) {
        document.querySelectorAll('main > section').forEach(el => el.classList.add('hide'));
        
        const target = document.getElementById(pageId + 'Page');
        if(target) target.classList.remove('hide');
        else if(pageId === 'detail') {
            document.getElementById('detailPage').classList.remove('hide');
            if(postId) loadDetailContent(postId);
        }

        // íƒ­ë°” ì—…ë°ì´íŠ¸ ë° ì•„ì´ì½˜ ìƒíƒœ ë³€ê²½
        document.querySelectorAll('.bottom-nav button').forEach(btn => {
            updateIconState(btn.id, false); // ëª¨ë‘ ë¹„í™œì„±í™”
            btn.classList.remove('text-primary-blue');
            btn.classList.add('text-gray-400');
        });

        const navBtn = document.getElementById('nav-' + pageId);
        if(navBtn) {
            updateIconState(navBtn.id, true); // ì„ íƒëœ íƒ­ í™œì„±í™”
            navBtn.classList.remove('text-gray-400');
            navBtn.classList.add('text-primary-blue');
        }

        const backBtn = document.getElementById('backBtn');
        if(pageId === 'home') backBtn.classList.add('hide');
        else backBtn.classList.remove('hide');
        
        if(pageId === 'newsletter') renderLetters('all');
        if(pageId === 'editorTalk') renderEditorTalks();
        if(pageId === 'moment') renderMoments();
        if(pageId === 'myPage') renderMyPage();

        currentTab = pageId;
        window.scrollTo(0,0);
    }
    
    // (ì´í•˜ goBack, toggleAuth, closeModal, handleLogin, updateUI í•¨ìˆ˜ëŠ” V9.0 ì½”ë“œ ìœ ì§€)
    function goBack() {
        if (currentTab === 'detail') { navigateTo('newsletter'); return; }
        navigateTo('home');
    }

    function toggleAuth() {
        if(currentUser) {
            if(confirm('ë¡œê·¸ì•„ì›ƒ í•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
                currentUser = null;
                alert('ë¡œê·¸ì•„ì›ƒ ë˜ì—ˆìŠµë‹ˆë‹¤.');
                updateUI();
                navigateTo('home');
            }
        } else {
            document.getElementById('authModal').style.display = 'flex';
        }
    }

    function closeModal(e, id) {
        if(e.target.id === id || e.target.closest('.close-btn')) {
            document.getElementById(id).style.display = 'none';
        }
    }

    function handleLogin() {
        const email = document.getElementById('authEmail').value;
        const password = document.getElementById('authPassword').value;

        if(email && password) {
            currentUser = {
                name: email.includes('happxi') ? 'í–…ì‚' : 'ë°©ë¬¸ì',
                email: email,
                isAdmin: ADMINS.includes(email)
            };
            document.getElementById('authModal').style.display = 'none';
            updateUI();
            alert(`[${currentUser.email}] ë¡œê·¸ì¸ ì„±ê³µ!`);
        } else {
            alert('ì´ë©”ì¼ê³¼ ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.');
        }
    }

    function updateUI() {
        const btn = document.getElementById('authBtnText');
        const greetingTitle = document.getElementById('greetingTitle');
        const greetingSub = document.getElementById('greetingSub');
        const adminBtn = document.getElementById('adminWriteBtn');
        const myProfileArea = document.getElementById('myProfileArea');

        if(currentUser) {
            btn.innerText = 'ë¡œê·¸ì•„ì›ƒ';
            greetingTitle.innerText = "í–…ì‚ë‹˜ ì˜¤ëŠ˜ë„ í–‰ë³µí•˜ì„¸ìš”!";
            greetingSub.innerText = "ë©”ë§ˆë¥¸ ì¼ìƒì— íœ´ì‹ í•œ ë°©ìš¸, ìíœ´ë ˆí„°";
            
            if(currentUser.isAdmin) adminBtn.classList.remove('hide');
            else adminBtn.classList.add('hide');

             myProfileArea.innerHTML = `
                <div class="bg-primary-light/50 p-6 rounded-3xl shadow-soft flex items-center gap-4">
                    <div class="w-16 h-16 rounded-full bg-primary-blue/30 flex items-center justify-center text-3xl">ğŸ‘‹</div>
                    <div>
                        <h3 class="text-xl font-bold text-primary-blue">${currentUser.name}ë‹˜</h3>
                        <p class="text-xs text-text-sub mt-1">${currentUser.email}</p>
                    </div>
                </div>
            `;
            
        } else {
            btn.innerText = 'ë¡œê·¸ì¸';
            greetingTitle.innerText = "ë‹¹ì‹ ì˜ í–‰ë³µ ë ˆí„° ê°€ì´ë“œ";
            greetingSub.innerText = "ì„±ì¥ê³¼ í–‰ë³µì„ ìœ„í•œ ê°€ì´ë“œë¥¼ ë§Œë‚˜ë³´ì„¸ìš”.";
            adminBtn.classList.add('hide');

            myProfileArea.innerHTML = `
                <div class="flex flex-col items-center justify-center bg-white p-8 rounded-3xl shadow-soft">
                    <p class="text-gray-400 mb-4">ë¡œê·¸ì¸ì´ í•„ìš”í•œ ì„œë¹„ìŠ¤ì…ë‹ˆë‹¤.</p>
                    <button onclick="toggleAuth()" class="px-6 py-2 bg-primary-blue text-white rounded-full font-bold shadow-md">ë¡œê·¸ì¸ í•˜ëŸ¬ê°€ê¸°</button>
                </div>
            `;
        }
         // í˜„ì¬ íƒ­ì˜ ì•„ì´ì½˜ ìƒíƒœë¥¼ ì¬í™•ì¸
        navigateTo(currentTab);
    }

    // --- Post Logic ---
    function loadDetailContent(postId) {
        const post = data.posts.find(p => p.id === postId);
        const area = document.getElementById('detailContentArea');
        
        if (post) {
            area.innerHTML = `
                <h2 class="text-3xl font-bold mb-4 text-text-main">${post.title}</h2>
                <div class="text-sm text-text-sub mb-6 border-b pb-2">
                    By ${post.author} (${post.date}) - [${post.category === 'lab' ? 'ìíœ´ë©' : post.category === 'letter' ? 'ìíœ´ë ˆí„°' : post.category}]
                </div>
                <div class="text-base leading-relaxed text-text-main">
                    <p>${post.content}</p>
                    <p class="mt-8 text-gray-500 italic border-t pt-4">... ì´í•˜ëŠ” ì‹¤ì œ ë ˆí„° ì „ë¬¸ì´ ì´ì–´ì§‘ë‹ˆë‹¤. ...</p>
                </div>
                <div class="h-32"></div>
            `;
        }
    }

    function updateModalForMoment(type) {
        const title = document.getElementById('writeModalTitle');
        const postTypeSelect = document.getElementById('postType');
        
        if (type === 'moment') {
            title.innerText = 'ë‚˜ë§Œì˜ ëª¨ë¨¼íŠ¸ ì‘ì„± âœ¨';
            postTypeSelect.value = 'moment';
        } else {
            title.innerText = 'ìƒˆ ê¸€ ì‘ì„± (ê´€ë¦¬ì)';
            postTypeSelect.value = 'letter';
        }
    }
    
    function showWriteModal() {
        if (!currentUser) {
            alert('ë¡œê·¸ì¸ í›„ ì´ìš©í•´ ì£¼ì„¸ìš”.');
            return;
        }

        document.getElementById('writeModal').style.display = 'flex';
        
        const postTypeSelect = document.getElementById('postType');
        if (currentUser.isAdmin) {
            postTypeSelect.innerHTML = `
                <option value="letter">ìíœ´ë ˆí„°/ìíœ´ë© (ê´€ë¦¬ì ì „ìš©)</option>
                <option value="moment">ëª¨ë¨¼íŠ¸ (ëª¨ë‘ ì‘ì„± ê°€ëŠ¥)</option>
            `;
            postTypeSelect.value = 'letter';
        } else {
            postTypeSelect.innerHTML = `<option value="moment">ëª¨ë¨¼íŠ¸ ì‘ì„±</option>`;
            postTypeSelect.value = 'moment';
        }
        updateModalForMoment(postTypeSelect.value);
    }
    
    function checkAuthAndWriteMoment() {
        if (!currentUser) {
            alert('ëª¨ë¨¼íŠ¸ ì‘ì„±ì€ ë¡œê·¸ì¸ í›„ ì´ìš© ê°€ëŠ¥í•©ë‹ˆë‹¤.');
            return;
        }
        showWriteModal();
        updateModalForMoment('moment');
    }

    function submitPost() {
        const type = document.getElementById('postType').value;
        const title = document.getElementById('postTitle').value;
        const content = document.getElementById('postContent').value;
        
        if (!title || !content) {
            alert('ì œëª©ê³¼ ë‚´ìš©ì„ ëª¨ë‘ ì…ë ¥í•´ì£¼ì„¸ìš”.');
            return;
        }

        const newPost = {
            id: Date.now(),
            type: type,
            category: type === 'moment' ? 'moment' : 'letter',
            title: title,
            content: content,
            author: currentUser.name,
            date: new Date().toISOString().split('T')[0].replace(/-/g, '.'),
            imgColor: type === 'moment' ? ['bg-red-100', 'bg-purple-100', 'bg-teal-100'][Math.floor(Math.random() * 3)] : null,
            height: type === 'moment' ? ['h-40', 'h-52', 'h-64'][Math.floor(Math.random() * 3)] : null,
            isNew: true
        };
        
        data.posts.unshift(newPost);
        document.getElementById('writeModal').style.display = 'none';
        alert(`${type === 'moment' ? 'ëª¨ë¨¼íŠ¸' : 'ìƒˆ ê¸€'}ì´ ì„±ê³µì ìœ¼ë¡œ ë“±ë¡ë˜ì—ˆìŠµë‹ˆë‹¤.`);
        
        navigateTo(type === 'moment' ? 'moment' : 'newsletter');
    }

    // --- Render Functions ---
    
    function renderLetters(filter) {
        const container = document.getElementById('letterListContainer');
        container.innerHTML = '';
        
        const list = data.posts.filter(p => p.type === 'letter' || p.type === 'editorTalk' && (filter === 'all' || p.category === filter));
        
        document.querySelectorAll('.filter-btn').forEach(btn => {
            if(btn.dataset.filter === filter) {
                btn.className = 'filter-btn px-4 py-1.5 rounded-full text-xs font-bold bg-primary-blue text-white shadow-sm transition';
            } else {
                btn.className = 'filter-btn px-4 py-1.5 rounded-full text-xs font-bold bg-white text-text-sub border border-gray-200 transition';
            }
        });

        list.forEach(item => {
            if (item.type === 'letter') {
                const badge = item.isNew ? `<span class="ml-2 px-1.5 py-0.5 rounded bg-new-pink text-[10px] font-bold text-red-600">NEW</span>` : '';
                const html = `
                    <div class="bg-white p-5 rounded-2xl shadow-sm border border-gray-50 mb-3 active:scale-[0.98] transition-transform cursor-pointer" onclick="navigateTo('detail', ${item.id})">
                        <div class="flex items-center mb-1">
                            <span class="text-[10px] font-bold text-primary-blue bg-primary-light/50 px-2 py-0.5 rounded mr-2">${item.category === 'lab' ? 'ìíœ´ë©' : 'ìíœ´ë ˆí„°'}</span>
                            <span class="text-xs text-gray-400">${item.date}</span>
                        </div>
                        <h3 class="text-lg font-bold text-text-main leading-tight">${item.title} ${badge}</h3>
                        <p class="text-sm text-text-sub mt-2 line-clamp-2">${item.content}</p>
                    </div>
                `;
                container.innerHTML += html;
            }
        });
    }

    function filterLetters(filter) {
        renderLetters(filter);
    }

    function renderEditorTalks() {
        const container = document.getElementById('editorTalkListContainer');
        container.innerHTML = '';
        const list = data.posts.filter(p => p.type === 'editorTalk');
        
        list.forEach(item => {
            const html = `
                <div class="bg-white p-4 rounded-xl shadow-sm border border-gray-50 mb-3 flex gap-4 items-start cursor-pointer" onclick="navigateTo('detail', ${item.id})">
                    <div class="w-10 h-10 rounded-full bg-gray-200 flex-shrink-0 flex items-center justify-center text-xs">ğŸ’¬</div>
                    <div>
                        <div class="flex items-baseline gap-2">
                            <h4 class="font-bold text-sm text-text-main">${item.author}</h4>
                            <span class="text-[10px] text-gray-400">${item.date}</span>
                        </div>
                        <p class="text-sm text-text-sub mt-1">${item.title}</p>
                    </div>
                </div>
            `;
            container.innerHTML += html;
        });
    }

    // V9.5: Masonry Layout ë Œë”ë§ í•¨ìˆ˜
    function renderMoments() {
        const container = document.getElementById('momentListContainer');
        container.innerHTML = '';
        const list = data.posts.filter(p => p.type === 'moment');

        // Masonry ë Œë”ë§ ë¡œì§ (ê°„ë‹¨ êµ¬í˜„)
        let htmlContent = '';
        list.forEach(item => {
            const html = `
                <div class="masonry-item ${item.imgColor} active:scale-[0.98] transition-transform cursor-pointer" onclick="navigateTo('detail', ${item.id})">
                    <div class="relative w-full ${item.height}">
                        <div class="absolute top-2 left-2 text-white bg-black/30 text-[10px] font-bold px-2 py-0.5 rounded-full">${item.author}</div>
                        <div class="absolute bottom-0 w-full p-3 bg-gradient-to-t from-black/60 to-transparent">
                            <p class="text-white text-sm font-medium truncate">${item.title}</p>
                            <span class="text-white/80 text-[10px]">${item.date}</span>
                        </div>
                    </div>
                </div>
            `;
            htmlContent += html;
        });
        container.innerHTML = htmlContent;
    }

    function renderMyPage() {
        if(!currentUser) { return; }
        // (ê¸°ëŠ¥ ìœ ì§€)
    }
    
    // ì´ˆê¸° í™ˆ íƒ­ í™œì„±í™” (ìŠ¤í¬ë¦½íŠ¸ ë¡œë“œ ì‹œ ì‹¤í–‰)
    navigateTo('home');
</script>
</body>
</html>
