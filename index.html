<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Jahyu Letter</title>
    
    <link href="https://fonts.googleapis.com/css2?family=Pretendard:wght@300;400;600;700&family=Dancing+Script:wght@700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://html2canvas.hertzen.com/dist/html2canvas.min.js"></script>
    
    <style>
        :root {
            /* ğŸ¨ ê°€ì‹œì„± ë†’ì€ ì»¬ëŸ¬ íŒ”ë ˆíŠ¸ */
            --primary: #8E70B3; 
            --primary-dark: #6A4C93;
            --primary-light: #F3E5F5;
            --bg-body: #FFFEF5; /* ì•„ì£¼ ì—°í•œ ì•„ì´ë³´ë¦¬ */
            --white: #ffffff;
            --text-main: #333333; /* ê°€ë…ì„± ì¢‹ì€ ì§„í•œ íšŒìƒ‰ */
            --text-sub: #666666;
            --border: #DDDDDD; 
            --shadow: 0 4px 15px rgba(0,0,0,0.08);
        }

        * { box-sizing: border-box; margin: 0; padding: 0; font-family: 'Pretendard', sans-serif; -webkit-tap-highlight-color: transparent; user-select: none; }
        body { background: var(--bg-body); color: var(--text-main); min-height: 100vh; display: flex; flex-direction: column; align-items: center; overflow-x: hidden; }
        
        /* ì•± ì»¨í…Œì´ë„ˆ */
        .app-container { width: 100%; max-width: 480px; min-height: 100vh; background: var(--bg-body); padding-bottom: 90px; padding-top: 70px; position: relative; }
        .clickable { cursor: pointer; transition: transform 0.1s, opacity 0.1s; }
        .clickable:active { transform: scale(0.97); opacity: 0.8; }

        /* í—¤ë” */
        .header { position: fixed; top: 0; width: 100%; max-width: 480px; height: 60px; background: rgba(255,255,255,0.95); backdrop-filter: blur(5px); display: flex; align-items: center; justify-content: center; z-index: 100; border-bottom: 1px solid var(--border); }
        .logo { font-family: 'Dancing Script', cursive; font-size: 26px; color: var(--primary); font-weight: 700; }

        /* ë²¤í†  ê·¸ë¦¬ë“œ (ê°€ì‹œì„± ê°•í™”) */
        .bento-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 12px; padding: 20px; }
        .bento-item { background: var(--white); border-radius: 16px; padding: 20px; box-shadow: var(--shadow); border: 1px solid #EAEAEA; display: flex; flex-direction: column; justify-content: space-between; min-height: 110px; }
        .bento-full { grid-column: span 2; background: linear-gradient(135deg, #B39CD0 0%, #9FA8DA 100%); color: white; border: none; }
        .bento-title { font-size: 16px; font-weight: 700; margin-bottom: 5px; color: var(--text-main); }
        .bento-full .bento-title { color: white; }
        .bento-desc { font-size: 12px; color: var(--text-sub); line-height: 1.4; }
        .bento-full .bento-desc { color: rgba(255,255,255,0.9); }
        .bento-icon { font-size: 28px; align-self: flex-end; margin-top: 10px; }

        /* ì¹´ë“œ & ë¦¬ìŠ¤íŠ¸ */
        .card { background: var(--white); border-radius: 16px; padding: 20px; box-shadow: 0 2px 8px rgba(0,0,0,0.05); border: 1px solid #EAEAEA; margin-bottom: 15px; }
        .section-header { font-size: 18px; font-weight: 700; margin-bottom: 15px; padding: 0 20px; color: #444; }

        /* ë¬´ë“œ ìº˜ë¦°ë” */
        .cal-container { background: var(--white); border-radius: 20px; padding: 20px; border: 1px solid var(--border); box-shadow: var(--shadow); }
        .cal-header { display: flex; justify-content: space-between; font-weight: 700; margin-bottom: 15px; color: #555; }
        .cal-grid { display: grid; grid-template-columns: repeat(7, 1fr); gap: 5px; text-align: center; }
        .day-cell { aspect-ratio: 1/1; border-radius: 8px; background: #f5f5f5; display: flex; align-items: center; justify-content: center; font-size: 11px; color: #ccc; position: relative; }
        .day-cell.today { border: 2px solid var(--primary); background: #fff; color: var(--primary); font-weight: 700; }
        .day-emoji { font-size: 20px; position: absolute; }

        /* ì—ë””í„° ì•„ì´ì½˜ */
        .editor-circle { width: 60px; height: 60px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 28px; border: 2px solid #fff; box-shadow: 0 3px 6px rgba(0,0,0,0.1); margin: 0 auto 5px; }
        .editor-name { font-size: 12px; font-weight: 600; text-align: center; color: #555; }

        /* ë²„íŠ¼ */
        .btn-main { width: 100%; padding: 14px; border-radius: 12px; border: none; font-weight: 700; font-size: 15px; margin-top: 10px; cursor: pointer; background: var(--primary); color: white; box-shadow: 0 4px 10px rgba(142, 112, 179, 0.3); }
        .btn-sub { background: #F5F5F5; color: #666; width: 100%; padding: 12px; border-radius: 12px; border: none; font-weight: 600; margin-top: 5px; }
        
        /* íŒì—… */
        .modal-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); z-index: 2000; display: none; justify-content: center; align-items: center; backdrop-filter: blur(3px); }
        .popup-box { background: white; width: 85%; max-width: 360px; padding: 30px; border-radius: 20px; text-align: center; box-shadow: 0 10px 30px rgba(0,0,0,0.2); position: relative; }

        /* ìŠ¤íƒ¬í”„ ë³´ë“œ */
        .stamp-grid { display: grid; grid-template-columns: repeat(5, 1fr); gap: 10px; margin: 20px 0; }
        .stamp-slot { aspect-ratio: 1/1; background: #F0F0F0; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 12px; color: #bbb; position: relative; }
        .stamp-slot.active { background: var(--primary); color: white; box-shadow: 0 2px 5px rgba(142, 112, 179, 0.4); font-weight: 700; }
        .gift-box { position: absolute; right: -2px; bottom: -2px; background: white; border-radius: 50%; padding: 3px; font-size: 14px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); }

        /* VIP ì¹´ë“œ ìƒì„±ìš© (ìˆ¨ê¹€ ì²˜ë¦¬) */
        #vipCardArea { 
            width: 300px; height: 450px; background: linear-gradient(135deg, #FFF0F5, #E6E6FA); 
            position: fixed; top: -9999px; left: -9999px; 
            display: flex; flex-direction: column; align-items: center; justify-content: center;
            border-radius: 20px; padding: 20px; text-align: center; box-shadow: 0 10px 20px rgba(0,0,0,0.1);
        }
        .vip-title { font-family:'Dancing Script'; font-size: 30px; color: var(--primary); margin-bottom: 20px; }
        .vip-name { font-size: 24px; font-weight: 800; color: #333; margin-bottom: 10px; }
        .vip-desc { font-size: 14px; color: #666; line-height: 1.6; }

        /* í”Œë ˆì´ ì½˜í…ì¸  ì• ë‹ˆë©”ì´ì…˜ */
        .shredder-box { transition: 1s; }
        .shredder-act { transform: translateY(100px) scale(0, 0); opacity: 0; }

        .hidden { display: none !important; }
        .fab { position: fixed; bottom: 100px; right: 20px; width: 55px; height: 55px; background: #333; border-radius: 50%; color: white; display: none; align-items: center; justify-content: center; font-size: 22px; box-shadow: 0 5px 15px rgba(0,0,0,0.3); z-index: 900; }
        .fab.show { display: flex; }
    </style>
</head>
<body>

    <!-- ì•Œë¦¼ íŒì—… -->
    <div id="customAlert" class="modal-overlay" style="z-index: 3000;">
        <div class="popup-box">
            <div style="font-size:40px; margin-bottom:15px;">ğŸŒ¿</div>
            <div id="alertMsg" style="margin-bottom:20px; font-weight:600; color:#333; line-height:1.5; word-break:keep-all;">ì•Œë¦¼ ë‚´ìš©</div>
            <button onclick="window.closeAlert()" class="btn-main">í™•ì¸</button>
        </div>
    </div>

    <!-- VIP ì¹´ë“œ ìƒì„± ì˜ì—­ (ìˆ¨ê¹€) -->
    <div id="vipCardArea">
        <div class="vip-title">Jahyu VIP</div>
        <div style="font-size:50px; margin-bottom:20px;">ğŸ‘‘</div>
        <div class="vip-name" id="vipNameTarget">User Name</div>
        <div class="vip-desc">ìœ„ ì‚¬ëŒì€ ì˜¨ì „í•œ íœ´ì‹ì„ ì¦ê¸¸ ì¤„ ì•„ëŠ”<br>ìíœ´ë ˆí„°ì˜ ì†Œì¤‘í•œ VIPì„ì„ ì¸ì¦í•©ë‹ˆë‹¤.</div>
        <div style="margin-top:30px; font-size:12px; color:#aaa;">Jahyu Letter Official</div>
    </div>

    <!-- í—¤ë” -->
    <header class="header">
        <div class="logo">Jahyu Letter</div>
    </header>

    <div id="appContainer" class="app-container"></div>

    <!-- í•˜ë‹¨ ë„¤ë¹„ê²Œì´ì…˜ -->
    <nav class="bottom-nav">
        <div class="nav-item clickable" onclick="window.renderTab('home')"><i class="fas fa-home"></i>í™ˆ</div>
        <div class="nav-item clickable" onclick="window.renderTab('letter')"><i class="fas fa-envelope-open-text"></i>ë ˆí„°</div>
        <div class="nav-item clickable" onclick="window.renderTab('mood')"><i class="fas fa-calendar-check"></i>ë¬´ë“œ</div>
        <div class="nav-item clickable" onclick="window.renderTab('editor')"><i class="fas fa-comment-dots"></i>ì—ë””í„°</div>
        <div class="nav-item clickable" onclick="window.renderTab('mypage')"><i class="fas fa-user"></i>ë§ˆì´</div>
    </nav>

    <div id="fab" class="fab clickable" onclick="window.openWriteModal()"><i class="fas fa-pen"></i></div>

    <!-- ë¡œê·¸ì¸ ëª¨ë‹¬ -->
    <div id="authModal" class="modal-overlay" style="display:flex;">
        <div class="popup-box">
            <h2 style="font-family:'Dancing Script'; color:var(--primary); margin-bottom:10px; font-size:32px;">Jahyu</h2>
            <p style="color:#666; margin-bottom:25px; font-size:14px;">ë©”ë§ˆë¥¸ ì¼ìƒ ì† íœ´ì‹ í•œ ë°©ìš¸ ğŸ’§</p>
            <input type="email" id="authEmail" style="width:100%; padding:15px; border:1px solid #ddd; border-radius:10px; margin-bottom:10px;" placeholder="ì´ë©”ì¼">
            <input type="password" id="authPw" style="width:100%; padding:15px; border:1px solid #ddd; border-radius:10px; margin-bottom:10px;" placeholder="ë¹„ë°€ë²ˆí˜¸">
            <div id="signupFields" class="hidden">
                <input type="text" id="authNick" style="width:100%; padding:15px; border:1px solid #ddd; border-radius:10px; margin-bottom:10px;" placeholder="ë‹‰ë„¤ì„">
            </div>
            <button onclick="window.doLogin()" class="btn-main" id="loginBtn">ë¡œê·¸ì¸</button>
            <button onclick="window.toggleSignup()" class="btn-sub" id="signupBtn">íšŒì›ê°€ì…</button>
        </div>
    </div>

    <!-- ê¸€ì“°ê¸°/ê´€ë¦¬ ëª¨ë‹¬ -->
    <div id="writeModal" class="modal-overlay">
        <div class="popup-box" style="text-align:left; max-width:400px; width:90%;">
            <h3 id="modalTitle" style="text-align:center; color:#333; margin-bottom:20px;">ê¸°ë¡í•˜ê¸°</h3>
            
            <div id="moodForm" class="hidden">
                <div id="emojiList" style="display:grid; grid-template-columns:repeat(5,1fr); gap:8px; margin-bottom:15px;"></div>
                <textarea id="moodContent" style="width:100%; padding:15px; border:1px solid #ddd; border-radius:10px; height:80px; resize:none;" placeholder="ì˜¤ëŠ˜ ê¸°ë¶„ì€ ì–´ë• ë‚˜ìš”?"></textarea>
            </div>

            <div id="adminForm" class="hidden">
                <select id="postType" style="width:100%; padding:10px; margin-bottom:10px; border-radius:10px; border:1px solid #ddd;">
                    <option value="editor">â˜•ï¸ ì—ë””í„° í†¡</option>
                    <option value="letter">ğŸ’Œ ìíœ´ë ˆí„°/ë©</option>
                    <option value="notice">ğŸ“¢ ê³µì§€ì‚¬í•­</option>
                </select>
                <input type="text" id="postTitle" style="width:100%; padding:10px; margin-bottom:10px; border-radius:10px; border:1px solid #ddd;" placeholder="ì œëª© (ì„ íƒ)">
                <textarea id="postContent" style="width:100%; padding:15px; border:1px solid #ddd; border-radius:10px; height:120px; resize:none;" placeholder="ë‚´ìš©"></textarea>
                <input type="text" id="postUrl" style="width:100%; padding:10px; margin-bottom:10px; border-radius:10px; border:1px solid #ddd;" placeholder="ê´€ë ¨ URL">
            </div>

            <button onclick="window.submitPost()" class="btn-main">ë“±ë¡í•˜ê¸°</button>
            <button onclick="window.closeModal()" class="btn-sub">ë‹«ê¸°</button>
        </div>
    </div>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
        import { getAuth, createUserWithEmailAndPassword, signInWithEmailAndPassword, signOut, onAuthStateChanged, updateProfile } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";
        import { getFirestore, collection, addDoc, getDocs, doc, setDoc, getDoc, query, where, orderBy, deleteDoc, updateDoc } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

        const firebaseConfig = {
            apiKey: "AIzaSyDq2eT8H6tNcsrT8dhZWsEyyMZbpCZIZZQ",
            authDomain: "jahyu-e24cd.firebaseapp.com",
            databaseURL: "https://jahyu-e24cd-default-rtdb.firebaseio.com",
            projectId: "jahyu-e24cd",
            storageBucket: "jahyu-e24cd.firebasestorage.app",
            messagingSenderId: "955637836464",
            appId: "1:955637836464:web:096ed0c28e0070f4fca975",
            measurementId: "G-CTDZFNYJV7"
        };

        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        const db = getFirestore(app);

        let currentUser = null;
        let currentTab = 'home';
        let isAdmin = false;
        let isSuperAdmin = false;
        let selectedEmoji = null;

        // ê´€ë¦¬ì ì„¤ì •
        const ADMIN_EMAILS = ['happci@test.com', 'gocal@test.com', 'yudan@test.com', 'sunny@test.com', 'elly@test.com'];
        const SUPER_ADMIN = 'happci@test.com';

        // ì—ë””í„° ì•„ì´ì½˜ ë°ì´í„° (ë°°ê²½ìƒ‰ ë° ì´ëª¨ì§€)
        const EDITORS = [
            { id: 'happci', name: 'í–…ì”¨', icon: 'âœï¸', bg: '#FFEBEE' },
            { id: 'elly', name: 'ì—˜ë¦¬', icon: 'ğŸ¥¯', bg: '#F3E5F5' },
            { id: 'sunny', name: 'ì¨ë‹ˆ', icon: 'ğŸª', bg: '#FFFDE7' },
            { id: 'yudan', name: 'ìœ ë‹¨', icon: 'ğŸ‘Ÿ', bg: '#E8F5E9' },
            { id: 'gocal', name: 'ê³ ì¹¼', icon: 'ğŸ“š', bg: '#E1F5FE' }
        ];

        // í”Œë ˆì´ ì½˜í…ì¸  ë°ì´í„° (DB ëŒ€ì²´ìš© í•˜ë“œì½”ë”© + ì¶”í›„ ê´€ë¦¬ì ì—°ë™ ê°€ëŠ¥)
        let COOKIE_MSGS = ["ì ì‹œ ë©ˆì¶°ë„ ê´œì°®ì•„ìš”.", "ë‹¹ì‹ ì˜ ì†ë„ëŠ” í‹€ë¦¬ì§€ ì•Šì•˜ì–´ìš”.", "ì˜¤ëŠ˜ë„ ë²„í‹°ëŠë¼ ê³ ìƒí–ˆì–´ìš”.", "ì‰¼ì€ ê²Œìœ¼ë¦„ì´ ì•„ë‹ˆì—ìš”."];
        let BALANCE_GAME = { q: "ì´ë²ˆ ì£¼ë§, ë‹¹ì‹ ì˜ ì„ íƒì€?", a: "í•˜ë£¨ì¢…ì¼ ì ìê¸°", b: "ë§›ì§‘ ì˜¤í”ˆëŸ°" };

        const MOODS = ['â˜ï¸','ğŸ˜Š','ğŸ¥°','ğŸ˜­','ğŸ˜¡','ğŸ”¥','â˜”','ğŸ€','ğŸ·','ğŸ§¸','ğŸ§','ğŸ’¸','ğŸ¥‘','ğŸ§','ğŸ§˜â€â™€ï¸','ğŸ‘»','ğŸ¤§','ğŸ§¶','ğŸŒ™','ğŸ°'];

        // --- ìœ í‹¸ë¦¬í‹° ---
        window.showAlert = (msg) => {
            document.getElementById('alertMsg').innerHTML = msg;
            document.getElementById('customAlert').style.display = 'flex';
        };
        window.closeAlert = () => document.getElementById('customAlert').style.display = 'none';

        window.closeModal = () => {
            document.getElementById('writeModal').style.display = 'none';
            const fab = document.getElementById('fab');
            if(currentTab === 'mood' || (isAdmin && (currentTab === 'editor' || currentTab === 'letter'))) fab.classList.add('show');
        };

        // --- íƒ­ ë Œë”ë§ ---
        window.renderTab = (tab) => {
            currentTab = tab;
            window.scrollTo(0, 0);
            
            const container = document.getElementById('appContainer');
            container.innerHTML = '';
            
            document.querySelectorAll('.nav-item').forEach(el => el.classList.remove('active'));
            const activeNav = document.querySelector(`.nav-item[onclick*="${tab}"]`);
            if (activeNav) activeNav.classList.add('active');

            const fab = document.getElementById('fab');
            fab.classList.remove('show');
            if (tab === 'mood') fab.classList.add('show');
            if (isAdmin && (tab === 'editor' || tab === 'letter')) fab.classList.add('show');

            if (tab === 'home') renderHome(container);
            else if (tab === 'letter') renderLetter(container);
            else if (tab === 'mood') renderMood(container);
            else if (tab === 'editor') renderEditor(container);
            else if (tab === 'mypage') renderMyPage(container);
            else if (tab === 'play') renderPlay(container);
        };

        // ğŸ  í™ˆ í™”ë©´
        function renderHome(container) {
            container.innerHTML = `
                <div style="padding:0 20px 20px;">
                    <div class="bento-item bento-full clickable" onclick="window.open('https://index-html-zak5.vercel.app/', '_blank')">
                        <div>
                            <div style="font-size:12px; opacity:0.9; margin-bottom:5px;">ì˜¤ëŠ˜ ë‹¹ì‹ ì˜ ë§ˆìŒì—, ì‰¼í‘œ í•˜ë‚˜ ğŸŒ¿</div>
                            <div class="bento-title">ë‚˜ì˜ íë§ ìœ í˜• í…ŒìŠ¤íŠ¸</div>
                        </div>
                        <div style="text-align:right; font-size:13px;">ì•Œì•„ë³´ëŸ¬ ê°€ê¸° ğŸ‘‰</div>
                    </div>
                </div>

                <div class="bento-grid">
                    <div class="bento-item clickable" onclick="window.renderTab('mood')" style="background:#FFF8E1;">
                        <div>
                            <div class="bento-title">ì˜¤ëŠ˜ì˜ ë¬´ë“œ</div>
                            <div class="bento-desc">ë§ˆìŒ ë‚ ì”¨ ê¸°ë¡í•˜ê¸°</div>
                        </div>
                        <div class="bento-icon">ğŸ¨</div>
                    </div>
                    
                    <div class="bento-item clickable" onclick="window.renderTab('play')" style="background:#F3E5F5;">
                        <div>
                            <div class="bento-title">í”Œë ˆì´</div>
                            <div class="bento-desc">ë³µì¡í•œ ìƒê° ë¹„ìš°ê¸°</div>
                        </div>
                        <div class="bento-icon">ğŸ¡</div>
                    </div>

                    <div class="bento-item clickable" onclick="window.renderTab('letter')" style="background:#E0F2F1;">
                        <div>
                            <div class="bento-title">ë ˆí„° ì½ê¸°</div>
                            <div class="bento-desc">ë©”ë§ˆë¥¸ ì¼ìƒ ì ì‹œê¸°</div>
                        </div>
                        <div class="bento-icon">ğŸ’Œ</div>
                    </div>

                    <div class="bento-item clickable" onclick="window.renderTab('editor')" style="background:#FFEBEE;">
                        <div>
                            <div class="bento-title">ì—ë””í„° í†¡</div>
                            <div class="bento-desc">ì´ë²ˆ ì£¼ ì–´ë• ë‚˜ìš”?</div>
                        </div>
                        <div class="bento-icon">ğŸ’¬</div>
                    </div>
                </div>
            `;
        }

        // ğŸ¡ í”Œë ˆì´ (ì±Œë¦°ì§€ ëŒ€ì²´)
        function renderPlay(container) {
            container.innerHTML = `
                <div style="padding:0 20px;">
                    <div class="section-header">ë³µì¡í•œ ë§ˆìŒ, ê°€ë³ê²Œ ë¹„ì›Œìš”!</div>
                    
                    <!-- ê±±ì • íŒŒì‡„ê¸° -->
                    <div class="card">
                        <div style="font-weight:700; margin-bottom:10px;">ğŸŒª ê±±ì • íŒŒì‡„ê¸°</div>
                        <p style="font-size:13px; color:#666; margin-bottom:10px;">ë§ˆìŒ ì† ê±±ì •ì„ ì ê³  ë²„íŠ¼ì„ ëˆ„ë¥´ë©´ ì‚¬ë¼ì ¸ìš”.</p>
                        <div id="shredderBox" class="shredder-box">
                            <input type="text" id="worryInput" style="width:100%; padding:10px; border:1px solid #ddd; border-radius:10px;" placeholder="ê±±ì •ì„ ì…ë ¥í•˜ì„¸ìš”...">
                            <button onclick="window.shredWorry()" class="btn-sub" style="background:#eee;">ê°ˆì•„ë²„ë¦¬ê¸° ğŸ—‘ï¸</button>
                        </div>
                    </div>

                    <!-- ë°¸ëŸ°ìŠ¤ ê²Œì„ -->
                    <div class="card" style="text-align:center;">
                        <div style="font-weight:700; margin-bottom:15px;">âš–ï¸ íë§ ë°¸ëŸ°ìŠ¤</div>
                        <p style="font-size:14px; margin-bottom:15px;">${BALANCE_GAME.q}</p>
                        <div style="display:flex; gap:10px;">
                            <button class="btn-main" onclick="window.showAlert('A ì„ íƒ! ì·¨í–¥ì´ í™•ê³ í•˜ì‹œë„¤ìš” ğŸ˜')">${BALANCE_GAME.a}</button>
                            <button class="btn-main" style="background:var(--primary-dark);" onclick="window.showAlert('B ì„ íƒ! ì—­ì‹œ íœ´ì‹ì€ ì´ê±°ì£  ğŸ‘')">${BALANCE_GAME.b}</button>
                        </div>
                    </div>

                    <!-- íœ´ì‹ ì¿ í‚¤ -->
                    <div class="card clickable" onclick="window.openCookie()" style="background:#FFFDE7; border-color:#FFF9C4;">
                        <div style="display:flex; justify-content:space-between; align-items:center;">
                            <div>
                                <div style="font-weight:700;">ğŸ¥  íœ´ì‹ ì¿ í‚¤ ë½‘ê¸°</div>
                                <div style="font-size:12px; margin-top:5px;">ì˜¤ëŠ˜ ë‚˜ì—ê²Œ í•„ìš”í•œ í•œ ë§ˆë””ëŠ”?</div>
                            </div>
                            <div style="font-size:30px;">âœ¨</div>
                        </div>
                    </div>
                </div>
            `;
        }

        window.shredWorry = () => {
            const input = document.getElementById('worryInput').value;
            if(!input) return window.showAlert("ê±±ì •ì„ ë¨¼ì € ì ì–´ì£¼ì„¸ìš”!");
            const box = document.getElementById('shredderBox');
            box.classList.add('shredder-act');
            setTimeout(() => {
                window.showAlert("ê±±ì •ì´ ë§ë”íˆ ì‚¬ë¼ì¡Œì–´ìš”! âœ¨");
                box.classList.remove('shredder-act');
                document.getElementById('worryInput').value = '';
            }, 1000);
        };

        window.openCookie = () => {
            const msg = COOKIE_MSGS[Math.floor(Math.random() * COOKIE_MSGS.length)];
            window.showAlert(`ğŸ’Œ ì˜¤ëŠ˜ì˜ ë©”ì‹œì§€<br><br>"${msg}"`);
        };

        // ğŸ’Œ ë ˆí„°
        function renderLetter(container) {
            container.innerHTML = `
                <div style="padding:0 20px;">
                    <div class="card" style="text-align:center;">
                        <h3 style="margin-bottom:10px;">ì´ë²ˆ ì£¼ ë ˆí„°, ì–¼ë§ˆë‚˜ ì½ìœ¼ì…¨ë‚˜ìš”? ğŸ§</h3>
                        <div class="rate-group">
                            <button class="rate-btn" onclick="window.checkRate(25)">25%</button>
                            <button class="rate-btn" onclick="window.checkRate(50)">50%</button>
                            <button class="rate-btn" onclick="window.checkRate(75)">75%</button>
                            <button class="rate-btn" onclick="window.checkRate(100)">100%</button>
                        </div>
                        <button onclick="window.open('https://maily.so/happci', '_blank')" class="btn-main">ë ˆí„° ë³´ëŸ¬ê°€ê¸° ğŸ’Œ</button>
                    </div>
                    <div class="section-header">ì§€ë‚œ ë ˆí„° ëª¨ì•„ë³´ê¸°</div>
                    <div id="letterList" class="card-list"></div>
                </div>
            `;
            window.fetchPosts('letter', 'letterList');
        }

        window.checkRate = (rate) => {
            let msg = "";
            if(rate === 25) msg = "ì‹œì‘ì´ ë°˜ì´ì—ìš”! ê°€ë³ê²Œ ì½ì–´ë³´ì„¸ìš” ğŸŒ±";
            else if(rate === 50) msg = "ì ˆë°˜ì´ë‚˜ ì½ìœ¼ì…¨êµ°ìš”! ì¡°ê¸ˆë§Œ ë” í˜ë‚´ìš” ğŸŒ¿";
            else if(rate === 75) msg = "ê±°ì˜ ë‹¤ ì½ì–´ê°€ìš”! í‘¹ ë¹ ì§€ì…¨ë„¤ìš” ğŸ“–";
            else msg = "ì™„ë…í•˜ì‹  ë‹¹ì‹ , ë©‹ì ¸ìš”! ì§€ì‹ê³¼ ê°ì„±ì´ +1 ë˜ì—ˆìŠµë‹ˆë‹¤ âœ¨";
            window.showAlert(msg);
        };

        // ğŸ¨ ë¬´ë“œ
        function renderMood(container) {
            container.innerHTML = `
                <div style="padding:0 20px;">
                    <div class="section-header">ì˜¤ëŠ˜ í•˜ë£¨, ë‹¹ì‹ ì˜ ë§ˆìŒ ë‚ ì”¨ëŠ”?</div>
                    <div class="cal-container" id="moodCapture">
                        <div class="cal-header">
                            <span>Mood Log</span>
                            <span>${new Date().getMonth()+1}ì›”</span>
                        </div>
                        <div class="cal-grid" style="margin-bottom:10px; font-size:12px; color:#888;">
                            <div>ì¼</div><div>ì›”</div><div>í™”</div><div>ìˆ˜</div><div>ëª©</div><div>ê¸ˆ</div><div>í† </div>
                        </div>
                        <div id="calGrid" class="cal-grid"></div>
                    </div>
                    <button onclick="window.saveImage('moodCapture')" class="btn-sub" style="margin-bottom:20px;"><i class="fas fa-download"></i> ìº˜ë¦°ë” ì´ë¯¸ì§€ ì €ì¥</button>
                    
                    <div class="section-header">ì§€ë‚œ ì´ì•¼ê¸°ë“¤</div>
                    <div id="moodList"></div>
                    <button onclick="window.fetchPosts('mood', 'moodList', 100)" class="btn-sub">ì´ì „ ê¸°ë¡ ë”ë³´ê¸°</button>
                </div>
            `;
            window.loadCalendar();
            window.fetchPosts('mood', 'moodList', 5);
        }

        // â˜•ï¸ ì—ë””í„° í†¡
        function renderEditor(container) {
            container.innerHTML = `
                <div style="padding:0 20px;">
                    <div class="section-header">ì—ë””í„° í”„ë¡œí•„</div>
                    <div class="editor-scroll">
                        ${EDITORS.map(e => `
                            <div class="editor-profile clickable" onclick="window.showAlert('${e.name}ì˜ í•œì¤„ ì†Œê°œ:<br>ë‹¹ì‹ ì˜ íœ´ì‹ì„ ì‘ì›í•©ë‹ˆë‹¤ ğŸ€')">
                                <div class="editor-circle" style="background:${e.bg}">${e.icon}</div>
                                <div class="editor-name">${e.name}</div>
                            </div>
                        `).join('')}
                    </div>