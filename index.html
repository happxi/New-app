<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ìíœ´ë ˆí„° - ììœ ë¡œìš´ ë‹¹ì‹ ì˜ íœ´ì‹ ê°€ì´ë“œ</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500;700&display=swap" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/remixicon@4.2.0/fonts/remixicon.css" rel="stylesheet">
    <style>
        * {
            font-family: 'Noto Sans KR', sans-serif;
        }

        /* ğŸ¨ íŠ¸ë Œë””í•œ ì»¬ëŸ¬ íŒ”ë ˆíŠ¸ */
        :root {
            --primary-gradient: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            --secondary-gradient: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            --bg-gradient: linear-gradient(135deg, #e0e7ff 0%, #f3e7e9 100%);
            --primary-blue: #667eea;
            --soft-blue: #e0e7ff;
            --accent-pink: #f093fb;
            --text-dark: #4a5568;
            --text-light: #718096;
            --glass-bg: rgba(255, 255, 255, 0.9);
            --glass-nav-bg: rgba(255, 255, 255, 0.7); /* ë„¤ë¹„ê²Œì´ì…˜ìš© íˆ¬ëª…ë„ ì¡°ì ˆ */
            --new-badge-gradient: linear-gradient(135deg, #ff6b6b 0%, #ff8787 100%);
            --secret-bg: linear-gradient(135deg, #667eea10 0%, #764ba210 100%);
            --happxi-bg: linear-gradient(135deg, #ffd70020 0%, #ffb34720 100%);
        }

        body {
            background: var(--bg-gradient);
            min-height: 100vh;
            overflow-x: hidden;
        }

        /* âœ¨ ìœ ë¦¬ì§ˆê° ë””ìì¸ */
        .glass-card {
            background: var(--glass-bg);
            backdrop-filter: blur(15px);
            border: 1px solid rgba(255, 255, 255, 0.3);
            box-shadow: 0 8px 32px rgba(102, 126, 234, 0.1);
        }

        /* ğŸ”’ ë³´ì•ˆ ë””ìì¸ (ê¸°ì¡´ ìœ ì§€) */
        .privacy-protected {
            background: var(--secret-bg);
            backdrop-filter: blur(15px);
            border: 2px solid rgba(102, 126, 234, 0.15);
            border-radius: 20px;
            padding: 20px;
            position: relative;
            overflow: hidden;
        }

        .privacy-protected::before {
            content: 'ğŸ”’';
            position: absolute;
            top: 8px;
            right: 8px;
            font-size: 16px;
            opacity: 0.2;
            animation: privacyPulse 3s ease-in-out infinite;
        }

        /* ğŸ‘‘ í–…ì”¨ ì „ìš© ê´€ë¦¬ì ë””ìì¸ (ê¸°ì¡´ ìœ ì§€) */
        .happxi-admin {
            background: var(--happxi-bg);
            backdrop-filter: blur(15px);
            border: 2px solid rgba(255, 215, 0, 0.3);
            border-radius: 20px;
            padding: 20px;
            position: relative;
            overflow: hidden;
        }

        .happxi-admin::before {
            content: 'ğŸ‘‘';
            position: absolute;
            top: 8px;
            right: 8px;
            font-size: 18px;
            animation: crownFloat 2s ease-in-out infinite;
        }

        @keyframes privacyPulse {
            0%, 100% { opacity: 0.2; transform: scale(1); }
            50% { opacity: 0.3; transform: scale(1.1); }
        }

        @keyframes crownFloat {
            0%, 100% { transform: translateY(0px) rotate(0deg); }
            50% { transform: translateY(-3px) rotate(5deg); }
        }

        /* ğŸŒŸ í”„ë¦¬ë¯¸ì—„ ë²„íŠ¼ ë””ìì¸ (ê¸°ì¡´ ìœ ì§€) */
        .premium-btn {
            background: var(--primary-gradient);
            color: white;
            padding: 12px 24px;
            border-radius: 25px;
            font-weight: 500;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3);
        }

        .premium-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(102, 126, 234, 0.4);
        }

        /* ğŸ¯ ì„¸ë ¨ëœ ì¹´ë“œ ë””ìì¸ (ê¸°ì¡´ ìœ ì§€) */
        .trend-card {
            background: var(--glass-bg);
            backdrop-filter: blur(15px);
            border-radius: 20px;
            padding: 20px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .trend-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 12px 30px rgba(102, 126, 234, 0.2);
        }

        /* ğŸ“± ëª¨ë°”ì¼ ìµœì í™” ë„¤ë¹„ê²Œì´ì…˜ */
        .bottom-nav {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            height: 75px; /* ë†’ì´ ì•½ê°„ ì¦ê°€ */
            z-index: 1000;
            background: var(--glass-nav-bg); /* ìœ ë¦¬ì§ˆê° ë°°ê²½ */
            backdrop-filter: blur(20px);
            border-top: 1px solid rgba(102, 126, 234, 0.1);
            box-shadow: 0 -5px 20px rgba(0, 0, 0, 0.05);
            display: flex;
            justify-content: space-around;
            align-items: center;
            padding: 0 5px;
        }

        .nav-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100%;
            color: var(--text-light);
            text-decoration: none;
            transition: all 0.3s ease;
            position: relative;
            padding: 5px 0;
            flex: 1;
            min-width: 0; /* overflow ë°©ì§€ */
        }

        .nav-item.active {
            color: var(--primary-blue);
        }

        .nav-icon-container {
            font-size: 22px; /* ì•„ì´ì½˜ í¬ê¸° */
            margin-bottom: 2px;
            transition: all 0.3s ease;
        }
        
        /* í•€í„°ë ˆìŠ¤íŠ¸ ì°¸ê³  - ê°ê°ì ì¸ í…Œë‘ë¦¬ ì•„ì´ì½˜ ìŠ¤íƒ€ì¼ */
        .nav-icon-container i {
            font-style: normal;
            display: inline-block;
            transition: all 0.3s ease;
            color: var(--text-light);
        }

        .nav-item.active .nav-icon-container i {
            color: var(--primary-blue);
        }
        
        /* ìíœ´ë© íŠ¹ìˆ˜ ë²„íŠ¼ ìŠ¤íƒ€ì¼ */
        .jahyu-lab-btn {
            transform: translateY(-15px);
            background: var(--secondary-gradient);
            color: white;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            box-shadow: 0 8px 20px rgba(240, 147, 251, 0.5);
            font-size: 14px;
            font-weight: 500;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-direction: column;
            transition: all 0.3s ease;
            padding-top: 5px;
        }

        .jahyu-lab-btn:hover {
            box-shadow: 0 10px 25px rgba(240, 147, 251, 0.7);
            transform: translateY(-18px);
        }
        
        .nav-text {
            font-size: 11px;
            line-height: 1;
        }

        /* ------------------------------------ */
        /* ê¸°íƒ€ ìŠ¤íƒ€ì¼ (ê¸°ì¡´ ìœ ì§€) */
        .hide { display: none !important; }
        .fade-in { animation: fadeIn 0.5s ease-out; }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        /* ìƒˆë¡œìš´ ìŠ¤íƒ€ì¼: í•„í„° ë²„íŠ¼ */
        .filter-btn {
            padding: 8px 15px;
            border-radius: 20px;
            font-weight: 500;
            transition: all 0.3s ease;
            border: 1px solid transparent;
        }

        .filter-btn.active {
            background: var(--primary-gradient);
            color: white;
            box-shadow: 0 4px 10px rgba(102, 126, 234, 0.3);
        }

        .filter-btn:not(.active) {
            background: rgba(255, 255, 255, 0.7);
            color: var(--text-dark);
            border-color: rgba(102, 126, 234, 0.2);
        }

        /* ê¸€ì ìƒ‰ìƒ ê·¸ë¼ë°ì´ì…˜ */
        .gradient-text {
            background: var(--primary-gradient);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            color: transparent;
        }
        
        /* ë¡œê·¸ì¸/íšŒì›ê°€ì… ì¸í’‹ ìŠ¤íƒ€ì¼ (ê¸°ì¡´ ìœ ì§€) */
        .login-input {
            width: 100%;
            padding: 12px 16px;
            border-radius: 15px;
            border: 2px solid rgba(102, 126, 234, 0.2);
            background: rgba(255, 255, 255, 0.8);
            transition: all 0.3s ease;
            margin-bottom: 15px;
        }
        
        .login-input:focus {
            outline: none;
            border-color: var(--primary-blue);
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

    </style>
</head>
<body>

<section id="authPage" class="p-5 pt-16 min-h-screen flex items-center justify-center fade-in">
    <div class="glass-card rounded-3xl p-8 max-w-sm w-full">
        <div class="text-center mb-6">
            <h2 class="text-3xl font-bold mb-2 gradient-text">
                ìíœ´ë ˆí„°
            </h2>
            <p class="text-gray-600">ë‹¹ì‹ ì˜ íŠ¹ë³„í•œ íœ´ì‹ì„ ìœ„í•œ ê³µê°„</p>
        </div>

        <form onsubmit="handleLogin(event)" id="loginForm">
            <h3 class="text-xl font-bold mb-4 text-gray-800">ë¡œê·¸ì¸</h3>
            <input type="email" id="loginEmail" placeholder="ì´ë©”ì¼ì„ ì…ë ¥í•˜ì„¸ìš”" class="login-input" required>
            <input type="password" id="loginPassword" placeholder="ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•˜ì„¸ìš”" class="login-input" required>

            <div class="flex items-center mb-4">
                <input type="checkbox" id="rememberLogin" class="mr-2">
                <label for="rememberLogin" class="text-sm text-gray-700">ë¡œê·¸ì¸ ì •ë³´ ì €ì¥í•˜ê¸°</label>
            </div>

            <button type="submit" class="premium-btn w-full">
                ë¡œê·¸ì¸ ğŸ’
            </button>
        </form>
        
        <div class="mt-6 text-center">
            <p class="text-sm text-gray-600">
                ê³„ì •ì´ ì—†ìœ¼ì‹ ê°€ìš”?
                <button onclick="showSignup()" class="text-purple-600 font-medium hover:underline">íšŒì›ê°€ì…</button>
            </p>
        </div>
    </div>
</section>


<div id="appContainer" class="min-h-screen pb-[75px] hide">

    <section id="homePage" class="p-5 pt-16 fade-in">
        <div class="text-center mb-8">
            <h1 class="text-3xl font-bold mb-2 gradient-text">
                í–…ì‚ë‹˜ ì˜¤ëŠ˜ë„ í–‰ë³µí•˜ì„¸ìš”! ğŸŒ¿
            </h1>
            <p class="text-gray-600">ë©”ë§ˆë¥¸ ì¼ìƒì— íœ´ì‹ í•œ ë°©ìš¸! âœ¨</p>
        </div>

        <div class="glass-card rounded-3xl p-6 mb-6">
            <div class="flex items-center justify-between">
                <div>
                    <h3 class="text-xl font-bold text-gray-800" id="userGreeting">í˜œë€ë‹˜ ì˜¤ëŠ˜ë„ í–‰ë³µí•˜ì„¸ìš”! ğŸŒ¿</h3>
                    <p class="text-sm text-gray-600 mt-1">ë‹¹ì‹ ì˜ íë§ì„ ìœ„í•œ, ìíœ´ë ˆí„°</p>
                </div>
                <div class="text-4xl animate-pulse">ğŸ’–</div>
            </div>
        </div>

        <div class="mb-6">
            <h3 class="text-xl font-bold mb-4 text-gray-800">HOT TREND</h3>
            <a href="https://index-html-zak5.vercel.app/" target="_blank" class="trend-card block">
                <div class="flex items-center justify-between">
                    <div>
                        <h4 class="font-bold text-lg text-gray-800">ë‚˜ë§Œì˜ íë§ ìœ í˜• TEST</h4>
                        <p class="text-sm text-gray-600 mt-1">ë‚˜ì—ê²Œ ë”± ë§ëŠ” íœ´ì‹ì„ ì°¾ì•„ë³´ì! ğŸ”®</p>
                    </div>
                    <div class="text-2xl">âœ¨</div>
                </div>
            </a>
        </div>

        <div class="grid grid-cols-3 gap-4">
            <a href="http://pf.kakao.com/_Jfjxgn/111753149" target="_blank" class="glass-card rounded-2xl p-4 text-center transition hover:shadow-lg">
                <div class="text-3xl mb-2">ğŸ’¬</div>
                <span class="text-xs text-gray-600">1:1 ì¹´í†¡</span>
            </a>
            <button class="glass-card rounded-2xl p-4 text-center transition hover:shadow-lg" onclick="alert('ë¬¸ì¥ ìˆ˜ì§‘ ê¸°ëŠ¥ ì¤€ë¹„ ì¤‘ì…ë‹ˆë‹¤')">
                <div class="text-3xl mb-2">ğŸ“–</div>
                <span class="text-xs text-gray-600">ë¬¸ì¥ ìˆ˜ì§‘</span>
            </button>
            <a href="https://maily.so/happci/posts/2nzn7qegrp5" target="_blank" class="glass-card rounded-2xl p-4 text-center transition hover:shadow-lg">
                <div class="text-3xl mb-2">ğŸ’Œ</div>
                <span class="text-xs text-gray-600">ë ˆí„° ë³´ê¸°</span>
            </a>
        </div>
    </section>

    <section id="newsletterPage" class="p-5 pt-16 hide fade-in">
        <h2 class="text-3xl font-bold mb-2 text-gray-800">ìíœ´ë ˆí„° ì•„ì¹´ì´ë¸Œ</h2>
        <p class="text-gray-600 mb-6">ìíœ´ë ˆí„°ì™€ ìíœ´ë©ì„ ì£¼ì œë³„ë¡œ í•œ ëˆˆì—!</p>

        <div class="flex gap-3 mb-6">
            <button id="filterAll" class="filter-btn active" onclick="filterLetters('all')">
                ì „ì²´
            </button>
            <button id="filterJahyuLetter" class="filter-btn" onclick="filterLetters('ìíœ´ë ˆí„°')">
                <span class="font-bold gradient-text">ìíœ´ë ˆí„°</span>
            </button>
            <button id="filterJahyuLab" class="filter-btn" onclick="filterLetters('ìíœ´ë©')">
                <span class="font-bold gradient-text">ìíœ´ë©</span>
            </button>
        </div>

        <div id="lettersFeed" class="space-y-4">
            </div>
    </section>

    <section id="editorTalkPage" class="p-5 pt-16 hide fade-in">
        <div class="flex items-center justify-between mb-6">
            <div>
                <h2 class="text-3xl font-bold text-gray-800">ì—ë””í„° í†¡</h2>
                <p class="text-gray-600 mt-1" id="editorTalkDescription">ì—ë””í„°ì™€ í–…ì‚ë‹˜ë“¤ì´ ì†Œí†µí•˜ëŠ” ê³µê°„</p>
            </div>
        </div>

        <div id="editorComposeArea" class="editor-compose hide">
            <form onsubmit="submitEditorPost(event)">
                <h4 class="font-bold text-gray-800 mb-3">ğŸ“ ì—ë””í„°ë‹˜ ê¸€ì“°ê¸°</h4>
                <textarea placeholder="í–…ì‚ë‹˜ë“¤ì—ê²Œ ì‘ì›ì˜ ë©”ì‹œì§€ë¥¼ ì „í•´ì£¼ì„¸ìš”!" rows="4" class="compose-textarea mb-3" id="editorContent"></textarea>
                <button type="submit" class="premium-btn">
                    ê²Œì‹œí•˜ê¸° ğŸ’¬
                </button>
            </form>
        </div>

        <div id="editorTalkFeed" class="space-y-4">
            </div>
    </section>

    <section id="momentPage" class="p-5 pt-16 hide fade-in">
        <div class="flex items-center justify-between mb-6">
            <div>
                <h2 class="text-3xl font-bold text-gray-800">ëª¨ë¨¼íŠ¸</h2>
                <p class="text-gray-600 mt-1">í–…ì‚ë‹˜ë“¤ì˜ ì¼ìƒì´ ê¶ê¸ˆí•´ìš”! í–‰ë³µí•œ ìˆœê°„ë“¤ì„ ê³µìœ í•´ì£¼ì„¸ìš”!</p>
            </div>
            <button onclick="alert('ëª¨ë¨¼íŠ¸ ì‘ì„± ê¸°ëŠ¥ ì¤€ë¹„ ì¤‘ì…ë‹ˆë‹¤. âœ¨')" class="premium-btn">
                ì‘ì„±í•˜ê¸° âœ¨
            </button>
        </div>

        <div id="momentsFeed" class="space-y-4">
            <div class="moment-card">
                <div class="flex items-center mb-3">
                    <div class="w-10 h-10 rounded-full bg-gradient-to-r from-pink-400 to-red-400 flex items-center justify-center text-white font-bold mr-3">
                        í˜œ
                    </div>
                    <div class="flex-1">
                        <p class="font-bold text-gray-800">í˜œë€</p>
                        <p class="text-xs text-gray-500">3ì‹œê°„ ì „</p>
                    </div>
                </div>
                <p class="text-gray-700 mb-3">ì˜¤ëŠ˜ì€ ë‚ ì”¨ë„ ì¢‹ê³  ì¹´í˜ì—ì„œ ì—¬ìœ ë¡­ê²Œ ì‰¬ê³  ìˆì–´ìš” â˜•ï¸âœ¨</p>
                <img src="https://picsum.photos/seed/cafe1/400/300.jpg" alt="ì¹´í˜ ì´ë¯¸ì§€" class="w-full rounded-xl mb-3">
                <div class="flex items-center justify-between text-sm text-gray-600">
                    <div class="flex gap-4">
                        <span>ğŸ’™ 12</span>
                        <span>ğŸ’¬ 3</span>
                    </div>
                    <span>ğŸ‘ï¸ 234</span>
                </div>
            </div>
        </div>
    </section>

    <section id="sanctuaryPage" class="p-5 pt-16 hide fade-in">
        <div class="flex items-center justify-between mb-6">
            <div>
                <h2 class="text-3xl font-bold text-gray-800">ì˜¤ëŠ˜ì˜ ë¬´ë“œ</h2>
                <p class="text-gray-600 mt-1" id="moodDescription">
                    í–…ì‚ë‹˜ì´ ì˜¤ëŠ˜ ëŠë‚€ ê°ì •ê³¼ ìƒê°ë“¤ì„ ì†”ì§í•˜ê²Œ ê¸°ë¡í•´ ë³´ì„¸ìš”!
                </p>
            </div>
            <button onclick="alert('ì˜¤ëŠ˜ì˜ ë¬´ë“œ ê¸°ë¡ ê¸°ëŠ¥ ì¤€ë¹„ ì¤‘ì…ë‹ˆë‹¤. âœï¸')" class="premium-btn" id="moodWriteBtn">
                ê¸°ë¡í•˜ê¸° âœï¸
            </button>
        </div>

        <div id="diaryList" class="space-y-4">
            </div>
    </section>

    <section id="myPage" class="p-5 pt-16 hide fade-in">
        <h2 class="text-3xl font-bold mb-4 text-gray-800">ë§ˆì´í˜ì´ì§€</h2>

        <div class="glass-card rounded-2xl p-6 mb-6">
            <div class="flex items-center">
                <div class="w-20 h-20 rounded-full bg-gradient-to-r from-purple-400 to-pink-400 flex items-center justify-center text-white text-2xl font-bold mr-4" id="profileAvatar">
                    í˜œ
                </div>
                <div>
                    <h3 class="text-xl font-bold text-gray-800" id="profileName">í˜œë€</h3>
                    <p class="text-gray-600" id="profileEmail">hyeran@example.com</p>
                    <div class="mt-2">
                        <span class="bg-purple-100 text-purple-800 px-3 py-1 rounded-full text-xs" id="profileRole">ì¼ë°˜ íšŒì›</span>
                    </div>
                </div>
            </div>
        </div>

        <div class="space-y-3 mb-6">
            <button class="w-full glass-card rounded-2xl p-4 text-left">
                <span class="font-medium text-gray-800">ì„¤ì •</span>
            </button>
            <button class="w-full glass-card rounded-2xl p-4 text-left">
                <span class="font-medium text-gray-800">ì•Œë¦¼</span>
            </button>
            <button class="w-full glass-card rounded-2xl p-4 text-left">
                <span class="font-medium text-gray-800">ê³ ê°ì„¼í„°</span>
            </button>
        </div>

        <button onclick="handleLogout()" class="w-full bg-red-500 text-white rounded-2xl p-4 font-medium hover:bg-red-600 transition">
            ë¡œê·¸ì•„ì›ƒ
        </button>
    </section>
</div>

<nav class="bottom-nav">
    <a href="#" class="nav-item active" onclick="navigateTo('home', event)">
        <div class="nav-icon-container"><i class="ri-home-4-line"></i></div>
        <span class="nav-text">í™ˆ</span>
    </a>
    <a href="#" class="nav-item" onclick="navigateTo('newsletter', event)">
        <div class="nav-icon-container"><i class="ri-mail-line"></i></div>
        <span class="nav-text">ë ˆí„°</span>
    </a>
    <a href="#" class="nav-item" onclick="navigateTo('editorTalk', event)">
        <div class="nav-icon-container"><i class="ri-message-3-line"></i></div>
        <span class="nav-text">ì—ë””í„°í†¡</span>
    </a>
    <a href="#" class="jahyu-lab-btn" onclick="navigateTo('jahyuLab', event)">
        <div class="text-2xl leading-none">ğŸ§ª</div>
        <span class="text-xs leading-none mt-0.5">ìíœ´ë©</span>
    </a>
    <a href="#" class="nav-item" onclick="navigateTo('moment', event)">
        <div class="nav-icon-container"><i class="ri-camera-line"></i></div>
        <span class="nav-text">ëª¨ë¨¼íŠ¸</span>
    </a>
    <a href="#" class="nav-item" onclick="navigateTo('sanctuary', event)">
        <div class="nav-icon-container"><i class="ri-emotion-line"></i></div>
        <span class="nav-text">ë¬´ë“œ</span>
    </a>
    <a href="#" class="nav-item" onclick="navigateTo('myPage', event)">
        <div class="nav-icon-container"><i class="ri-user-line"></i></div>
        <span class="nav-text">ë§ˆì´</span>
    </a>
</nav>

<script>
    // ğŸ” ë³´ì•ˆ 10ë‹¨ê³„ ê°•í™” - ì¸ì¦ ë° ë°ì´í„° ê´€ë¦¬ ì‹œìŠ¤í…œ
    const appData = {
        users: [
            { id: 'happxi@jahyu.com', name: 'í–…ì”¨', password: 'admin123', role: 'super_admin', avatar: 'í–…', permissions: ['view_all_moods', 'manage_system', 'write_editor_talk'] },
            { id: 'elly@jahyu.com', name: 'ì—˜ë¦¬', password: 'admin123', role: 'admin', avatar: 'ì—˜', permissions: ['basic_access', 'write_editor_talk'] },
            { id: 'gokal@jahyu.com', name: 'ê³ ì¹¼', password: 'admin123', role: 'admin', avatar: 'ê³ ', permissions: ['basic_access', 'write_editor_talk'] },
            { id: 'yudan@jahyu.com', name: 'ìœ ë‹¨', password: 'admin123', role: 'admin', avatar: 'ìœ ', permissions: ['basic_access', 'write_editor_talk'] },
            { id: 'sunny@jahyu.com', name: 'ì¨ë‹ˆ', password: 'admin123', role: 'admin', avatar: 'ì¨', permissions: ['basic_access', 'write_editor_talk'] },
            { id: 'hyeran@example.com', name: 'í˜œë€', password: 'user123', role: 'user', avatar: 'í˜œ', permissions: ['basic_access'] }
        ],
        currentUser: null,
        diaries: [
            { id: 1, userId: 'hyeran@example.com', date: '2025-12-10', title: 'ì˜¤ëŠ˜ í•˜ë£¨ ë„ˆë¬´ ì§€ì³¤ì–´ìš”', content: 'ì¼ì´ ë„ˆë¬´ ë§ì•„ì„œ í˜ë“¤ì—ˆì§€ë§Œ, ì§‘ì— ì™€ì„œ ë”°ëœ»í•œ ì°¨ë¥¼ ë§ˆì‹œë‹ˆ ì¡°ê¸ˆ í’€ë¦¬ë„¤ìš”.', emotion: 'ğŸ˜©', moodName: 'ì§€ì¹¨' },
            { id: 2, userId: 'hyeran@example.com', date: '2025-12-09', title: 'ìƒˆë¡œìš´ ì‹œì‘ì— ëŒ€í•œ ê¸°ëŒ€ì™€ ë¶ˆì•ˆ', content: 'ì„±ì¥í†µì´ê¸°ë¥¼ ë°”ë¼ë©°.', emotion: 'ğŸ˜Œ', moodName: 'í‰ì˜¨' },
            { id: 3, userId: 'hyeran@example.com', date: '2025-12-07', title: 'ì†Œí™•í–‰, ë”°ëœ»í•œ ë¼ë–¼ í•œ ì”', content: 'ëª¨ë“  í”¼ë¡œê°€ ë…¹ëŠ” ê¸°ë¶„.', emotion: 'ğŸ˜„', moodName: 'í–‰ë³µ' },
            { id: 4, userId: 'elly@jahyu.com', date: '2025-12-10', title: 'ê´€ë¦¬ìì˜ í•˜ë£¨', content: 'ì˜¤ëŠ˜ë„ ë‹¤ë“¤ ì—´ì‹¬íˆ í•˜ì…¨ë„¤ìš”!', emotion: 'ğŸ¥°', moodName: 'ì„¤ë ˜' },
            { id: 5, userId: 'happxi@jahyu.com', date: '2025-12-08', title: 'ëª¨ë‘ë¥¼ ì‘ì›í•©ë‹ˆë‹¤', content: 'ì˜¤ëŠ˜ í•˜ë£¨ë„ ìˆ˜ê³ í–ˆì–´ìš”!', emotion: 'ğŸ¥°', moodName: 'ì„¤ë ˜' },
            { id: 6, userId: 'gokal@jahyu.com', date: '2025-12-06', title: 'ì£¼ë§ ê¸°ë‹¤ë ¤ì§', content: 'ì£¼ë§ì— ì‰¬ê³  ì‹¶ì–´ìš”.', emotion: 'ğŸ˜„', moodName: 'í–‰ë³µ' }
        ],
        moments: [
            { id: 1, userId: 'hyeran@example.com', content: 'ì˜¤ëŠ˜ì€ ë‚ ì”¨ë„ ì¢‹ê³  ì¹´í˜ì—ì„œ ì—¬ìœ ë¡­ê²Œ ì‰¬ê³  ìˆì–´ìš” â˜•ï¸âœ¨', likes: 12, comments: 3, views: 234, time: '3ì‹œê°„ ì „' }
        ],
        editorTalks: [
            { id: 1, userId: 'happxi@jahyu.com', content: 'í–…ì‚ë‹˜ë“¤! ì¼ì£¼ì¼ ì˜ ë²„í‹°ì…¨ë‚˜ìš”? ì£¼ë§ì—ëŠ” ì•„ë¬´ ìƒê° ì—†ì´ ì‰¬ì–´ì•¼ í•´ìš”! â˜•ï¸', likes: 45, comments: 8, time: '2ì‹œê°„ ì „', likedBy: [] },
            { id: 2, userId: 'elly@jahyu.com', content: 'ëª¨ë‘ ì˜¤ëŠ˜ í•˜ë£¨ë„ ì •ë§ ìˆ˜ê³  ë§ìœ¼ì…¨ì–´ìš”! ë‚´ì¼ì€ ë” ë¹›ë‚  ê±°ì˜ˆìš” âœ¨', likes: 23, comments: 5, time: '5ì‹œê°„ ì „', likedBy: [] }
        ],
        letters: [
            { id: 1, title: '32í˜¸. í‡´ì‚¬ í›„ ë²ˆì•„ì›ƒ, ì €ë§Œ ì´ëŸ°ê°€ìš”?', summary: 'í‡´ì‚¬ í›„ì—ë„ ì‰¬ì§€ ëª»í•˜ëŠ” ë‹¹ì‹ ì—ê²Œ...', type: 'ìíœ´ë ˆí„°', time: '3ì¼ ì „' },
            { id: 2, title: '31í˜¸. ì£¼ë§ì—ë„ ì¼ìƒê°ì´ ë©ˆì¶”ì§€ ì•Šì•„ìš”', summary: 'ì™„ì „í•œ íœ´ì‹ì„ ìœ„í•œ ë§ˆìŒ ë²—ê¸°ê¸°ë²•', type: 'ìíœ´ë ˆí„°', time: '1ì£¼ì¼ ì „' },
            { id: 3, title: '1í˜¸. ê¸€ì“°ê¸°, ì™œ í•´ì•¼ í•˜ëŠ”ê°€?', summary: 'ìíœ´ë© ì²« ë²ˆì§¸ ì´ì•¼ê¸°: ê¸€ì“°ê¸°ì˜ ì¤‘ìš”ì„±', type: 'ìíœ´ë©', time: '2ì£¼ì¼ ì „' },
            { id: 4, title: '30í˜¸. ë‚´ì¼ì˜ ë‚˜ì—ê²Œ ë¶€ë‹´ì„ ë„˜ê¸°ì§€ ì•Šê¸°', summary: 'ì˜¤ëŠ˜ í•  ì¼ì€ ì˜¤ëŠ˜ ëë‚´ê¸°', type: 'ìíœ´ë ˆí„°', time: '2ì£¼ì¼ ì „' },
            { id: 5, title: '2í˜¸. ê¸°íšì•ˆ ì‘ì„±ì˜ A to Z', summary: 'ì„±ê³µì ì¸ ë‰´ìŠ¤ë ˆí„° ê¸°íš ë…¸í•˜ìš°', type: 'ìíœ´ë©', time: '3ì£¼ì¼ ì „' }
        ]
    };

    let currentTab = 'home';
    let currentFilter = 'all'; // ë ˆí„° í•„í„° ìƒíƒœ

    // ğŸš€ ì•± ì´ˆê¸°í™”
    function initApp() {
        if (!checkAutoLogin()) {
            document.getElementById('authPage').classList.remove('hide');
        }
        setupEventListeners();
    }

    // ğŸ” ìë™ ë¡œê·¸ì¸ ì²´í¬
    function checkAutoLogin() {
        const savedLogin = localStorage.getItem('jahyuLogin');
        if (savedLogin) {
            try {
                const { email, password } = JSON.parse(savedLogin);
                const user = authenticateUser(email, password);
                if (user) {
                    appData.currentUser = user;
                    // ìë™ ë¡œê·¸ì¸ ì‹œ ë¡œê·¸ì¸ ì •ë³´ëŠ” ë°”ë¡œ ì œê±° (ë³´ì•ˆ ëª©ì )
                    // localStorage.removeItem('jahyuLogin'); 
                    showMainApp();
                    return true;
                }
            } catch (error) {
                localStorage.removeItem('jahyuLogin');
            }
        }
        return false;
    }

    // ğŸ” ì‚¬ìš©ì ì¸ì¦
    function authenticateUser(email, password) {
        const user = appData.users.find(u => u.id === email);
        if (!user) return null;
        if (user.password === password) {
            return {
                id: user.id,
                name: user.name,
                role: user.role,
                avatar: user.avatar,
                permissions: user.permissions
            };
        }
        return null;
    }

    // ğŸ‘¤ ë¡œê·¸ì¸ ì²˜ë¦¬
    function handleLogin(event) {
        event.preventDefault();
        const email = document.getElementById('loginEmail').value;
        const password = document.getElementById('loginPassword').value;
        const remember = document.getElementById('rememberLogin').checked;

        const user = authenticateUser(email, password);

        if (user) {
            appData.currentUser = user;

            if (remember) {
                localStorage.setItem('jahyuLogin', JSON.stringify({ email, password }));
            } else {
                localStorage.removeItem('jahyuLogin');
            }

            showMainApp();
        } else {
            alert('ì´ë©”ì¼ ë˜ëŠ” ë¹„ë°€ë²ˆí˜¸ê°€ ì˜¬ë°”ë¥´ì§€ ì•ŠìŠµë‹ˆë‹¤.');
        }
    }

    // ğŸšª ë¡œê·¸ì•„ì›ƒ
    function handleLogout() {
        if (confirm('ì •ë§ ë¡œê·¸ì•„ì›ƒí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
            appData.currentUser = null;
            localStorage.removeItem('jahyuLogin');
            
            document.getElementById('authPage').classList.remove('hide');
            document.getElementById('appContainer').classList.add('hide');

            navigateTo('auth'); // ë¡œê·¸ì¸ í˜ì´ì§€ë¡œ ì´ë™
        }
    }

    // ğŸ“± ë©”ì¸ ì•± í‘œì‹œ
    function showMainApp() {
        document.getElementById('authPage').classList.add('hide');
        document.getElementById('appContainer').classList.remove('hide');

        updateUserProfile();
        updateMoodPageForRole();
        updateEditorTalkPageForRole();
        renderLetters(currentFilter);
        navigateTo('home');
    }

    // ğŸ‘¤ ì‚¬ìš©ì í”„ë¡œí•„ ì—…ë°ì´íŠ¸ (ê¸°ì¡´ê³¼ ë™ì¼)
    function updateUserProfile() {
        if (!appData.currentUser) return;
        const user = appData.currentUser;
        
        document.getElementById('userGreeting').textContent = `${user.name}ë‹˜ ì˜¤ëŠ˜ë„ í–‰ë³µí•˜ì„¸ìš”! ğŸŒ¿`;
        document.getElementById('profileAvatar').textContent = user.avatar;
        document.getElementById('profileName').textContent = user.name;
        document.getElementById('profileEmail').textContent = user.id;

        let roleText = 'ì¼ë°˜ íšŒì›';
        let roleClass = 'bg-gray-100 text-gray-800';

        if (user.role === 'super_admin') {
            roleText = 'ğŸ‘‘ í–…ì”¨ (ìµœê³  ê´€ë¦¬ì)';
            roleClass = 'bg-yellow-100 text-yellow-800';
        } else if (user.role === 'admin') {
            roleText = 'ê´€ë¦¬ì';
            roleClass = 'bg-blue-100 text-blue-800';
        }

        const roleElement = document.getElementById('profileRole');
        if (roleElement) {
            roleElement.textContent = roleText;
            roleElement.className = `${roleClass} px-3 py-1 rounded-full text-xs`;
        }
    }

    // ğŸ­ ì—­í• ë³„ í˜ì´ì§€ ì„¤ì • (ê¸°ì¡´ê³¼ ë™ì¼)
    function updateMoodPageForRole() {
        const moodDescription = document.getElementById('moodDescription');
        if (!appData.currentUser) return;
        if (appData.currentUser.role === 'super_admin') {
            moodDescription.textContent = 'ëª¨ë“  í–…ì‚ë‹˜ë“¤ì˜ ê°ì •ì„ ëŒë³´ê³  ìˆìŠµë‹ˆë‹¤. ğŸ‘‘';
        } else {
            moodDescription.textContent = 'ë‹¹ì‹ ë§Œì˜ ê°œì¸ì ì¸ ê°ì • ê¸°ë¡ê³µê°„ì…ë‹ˆë‹¤. ğŸ”’';
        }
    }

    function updateEditorTalkPageForRole() {
        const editorDescription = document.getElementById('editorTalkDescription');
        const composeArea = document.getElementById('editorComposeArea');
        if (!appData.currentUser) return;
        if (isAdmin()) {
            editorDescription.textContent = 'ì—ë””í„°ì™€ í–…ì‚ë‹˜ë“¤ì´ ì†Œí†µí•˜ëŠ” ê³µê°„ (ê¸€ì“°ê¸° ê°€ëŠ¥)';
            composeArea.classList.remove('hide');
        } else {
            editorDescription.textContent = 'ì—ë””í„°ì™€ í–…ì‚ë‹˜ë“¤ì´ ì†Œí†µí•˜ëŠ” ê³µê°„ (ì½ê¸° ì „ìš©)';
            composeArea.classList.add('hide');
        }
    }

    function isAdmin() {
        return appData.currentUser && (appData.currentUser.role === 'super_admin' || appData.currentUser.role === 'admin');
    }
    
    // ğŸ“¬ ë ˆí„° ë Œë”ë§ ë° í•„í„°ë§
    function renderLetters(filterType) {
        const feed = document.getElementById('lettersFeed');
        if (!feed) return;

        feed.innerHTML = '';
        currentFilter = filterType;

        const filteredLetters = appData.letters.filter(letter => {
            if (filterType === 'all') return true;
            return letter.type === filterType;
        }).sort((a, b) => b.id - a.id); // ìµœì‹ ìˆœ ì •ë ¬

        if (filteredLetters.length === 0) {
            feed.innerHTML = `<div class="text-center text-gray-400 mt-10"><p>${filterType} ë ˆí„°ëŠ” ì•„ì§ ì—†ì–´ìš”! ğŸ’Œ</p></div>`;
            return;
        }

        filteredLetters.forEach(letter => {
            const letterCard = createLetterCard(letter);
            feed.appendChild(letterCard);
        });

        // í•„í„° ë²„íŠ¼ í™œì„±í™” ì—…ë°ì´íŠ¸
        document.querySelectorAll('.filter-btn').forEach(btn => btn.classList.remove('active'));
        document.getElementById('filter' + filterType.charAt(0).toUpperCase() + filterType.slice(1).replace('ë©', 'Lab')).classList.add('active');
        if (filterType === 'all') document.getElementById('filterAll').classList.add('active');
    }

    // ğŸ“¬ ë ˆí„° ì¹´ë“œ ìƒì„±
    function createLetterCard(letter) {
        const card = document.createElement('div');
        card.className = 'glass-card rounded-2xl p-5 cursor-pointer hover:shadow-lg transition';

        const typeColor = letter.type === 'ìíœ´ë ˆí„°' ? 'text-purple-600' : 'text-pink-600';
        const typeBg = letter.type === 'ìíœ´ë ˆí„°' ? 'bg-purple-100' : 'bg-pink-100';

        card.innerHTML = `
            <div class="flex items-center justify-between mb-2">
                <span class="${typeBg} ${typeColor} px-3 py-1 rounded-full text-xs font-medium">${letter.type}</span>
                <span class="text-xs text-gray-500">${letter.time}</span>
            </div>
            <h4 class="text-lg font-bold text-gray-800 mb-1">${letter.title}</h4>
            <p class="text-sm text-gray-600">${letter.summary}</p>
        `;

        return card;
    }

    // ğŸ“¬ ë ˆí„° í•„í„° ê¸°ëŠ¥
    function filterLetters(type) {
        renderLetters(type);
    }

    // ğŸ’¬ ì—ë””í„°í†¡ ë Œë”ë§, í† ê¸€ ì¢‹ì•„ìš”, ëŒ“ê¸€ ì…ë ¥ (ê¸°ì¡´ê³¼ ë™ì¼)
    function renderEditorTalks() {
        const feed = document.getElementById('editorTalkFeed');
        if (!feed) return;
        feed.innerHTML = '';
        if (!appData.currentUser) {
            feed.innerHTML = '<div class="text-center text-gray-400 mt-10"><p>ë¡œê·¸ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤.</p></div>';
            return;
        }
        const sortedTalks = appData.editorTalks.sort((a, b) => new Date(b.time) - new Date(a.time));
        sortedTalks.forEach(talk => {
            const talkCard = createEditorTalkCard(talk);
            feed.appendChild(talkCard);
        });
    }

    function createEditorTalkCard(talk) {
        const card = document.createElement('div');
        card.className = 'glass-card rounded-2xl p-5';
        const user = appData.users.find(u => u.id === talk.userId);
        const isLiked = talk.likedBy?.includes(appData.currentUser.id) || false;
        card.innerHTML = `
            <div class="flex items-center mb-3">
                <div class="w-10 h-10 rounded-full bg-gradient-to-r from-purple-400 to-pink-400 flex items-center justify-center text-white font-bold mr-3">
                    ${user.avatar}
                </div>
                <div class="flex-1">
                    <p class="font-bold text-gray-800">${user.name}</p>
                    <p class="text-xs text-gray-500">${talk.time}</p>
                </div>
            </div>
            <p class="text-gray-700 mb-4">${talk.content}</p>
            <div class="flex items-center gap-4">
                <button onclick="toggleLike(${talk.id})" class="interaction-btn ${isLiked ? 'liked' : ''}">
                    ğŸ’™ ${talk.likes}
                </button>
                <button onclick="showCommentInput(${talk.id})" class="interaction-btn">
                    ğŸ’¬ ${talk.comments}
                </button>
            </div>
        `;
        return card;
    }

    function toggleLike(talkId) {
        if (!appData.currentUser) return;
        const talk = appData.editorTalks.find(t => t.id === talkId);
        if (!talk) return;
        if (!talk.likedBy) talk.likedBy = [];
        const userIndex = talk.likedBy.indexOf(appData.currentUser.id);
        if (userIndex > -1) {
            talk.likedBy.splice(userIndex, 1);
            talk.likes--;
        } else {
            talk.likedBy.push(appData.currentUser.id);
            talk.likes++;
        }
        renderEditorTalks();
    }

    function showCommentInput(talkId) {
        const comment = prompt('ëŒ“ê¸€ì„ ì…ë ¥í•˜ì„¸ìš”:');
        if (comment) {
            const talk = appData.editorTalks.find(t => t.id === talkId);
            if (talk) {
                talk.comments++;
                renderEditorTalks();
                alert('ëŒ“ê¸€ì´ ì‘ì„±ë˜ì—ˆì–´ìš”! ğŸ’¬');
            }
        }
    }
    
    function submitEditorPost(event) {
        event.preventDefault();
        if (!isAdmin()) {
            alert('ê¶Œí•œì´ ì—†ìŠµë‹ˆë‹¤.');
            return;
        }
        const content = document.getElementById('editorContent').value.trim();
        if (!content) {
            alert('ë‚´ìš©ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.');
            return;
        }
        const newTalk = {
            id: Date.now(),
            userId: appData.currentUser.id,
            content: content,
            likes: 0,
            comments: 0,
            time: 'ë°©ê¸ˆ ì „',
            likedBy: []
        };
        appData.editorTalks.unshift(newTalk);
        renderEditorTalks();
        document.getElementById('editorContent').value = '';
        alert('ì—ë””í„°í†¡ì— ê²Œì‹œë˜ì—ˆì–´ìš”! ğŸ’¬');
    }

    // ğŸ“ ë‹¤ì´ì–´ë¦¬ ë Œë”ë§ (ê¸°ì¡´ê³¼ ë™ì¼)
    function renderDiaries() {
        const diaryList = document.getElementById('diaryList');
        if (!diaryList) return;
        diaryList.innerHTML = '';
        if (!appData.currentUser) {
            diaryList.innerHTML = '<div class="text-center text-gray-400 mt-10"><p>ë¡œê·¸ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤.</p></div>';
            return;
        }
        const visibleDiaries = getVisibleDiaries();
        if (visibleDiaries.length === 0) {
            const emptyMessage = isSuperAdmin()
                ? '<div class="text-center text-gray-400 mt-10"><div class="text-4xl mb-2">ğŸ“</div><p>ì•„ì§ ì•„ë¬´ëŸ° ê¸°ë¡ì´ ì—†ì–´ìš”.</p><p class="text-sm mt-1">í–…ì‚ë‹˜ë“¤ì˜ ì²« ê¸°ë¡ì„ ê¸°ë‹¤ë¦¬ëŠ” ì¤‘ì´ì—ìš”! ğŸ’</p></div>'
                : '<div class="text-center text-gray-400 mt-10"><div class="text-4xl mb-2">ğŸ“</div><p>ì•„ì§ ê¸°ë¡ëœ ë¬´ë“œê°€ ì—†ì–´ìš”.</p><p class="text-sm mt-1">ì²« ê¸°ë¡ì„ ë‚¨ê²¨ë³´ì„¸ìš”! ğŸ’</p></div>';
            diaryList.innerHTML = emptyMessage;
            return;
        }
        if (isSuperAdmin()) {
            const groupedDiaries = groupDiariesByUser(visibleDiaries);
            renderAdminDiaryView(groupedDiaries);
        } else {
            visibleDiaries.forEach(diary => {
                const isNew = isWithin7Days(diary.date);
                const diaryCard = createDiaryCard(diary, isNew);
                diaryList.appendChild(diaryCard);
            });
        }
    }

    function getVisibleDiaries() {
        if (!appData.currentUser) return [];
        return appData.diaries.filter(diary => {
            if (appData.currentUser.role === 'super_admin') {
                return true;
            }
            return diary.userId === appData.currentUser.id;
        }).sort((a, b) => new Date(b.date) - new Date(a.date));
    }

    function isSuperAdmin() {
        return appData.currentUser && appData.currentUser.role === 'super_admin';
    }

    function groupDiariesByUser(diaries) {
        const grouped = {};
        diaries.forEach(diary => {
            if (!grouped[diary.userId]) {
                const user = appData.users.find(u => u.id === diary.userId);
                grouped[diary.userId] = {
                    user: user,
                    diaries: []
                };
            }
            grouped[diary.userId].diaries.push(diary);
        });
        return grouped;
    }

    function renderAdminDiaryView(groupedDiaries) {
        const diaryList = document.getElementById('diaryList');

        const totalDiaries = Object.values(groupedDiaries).reduce((sum, group) => sum + group.diaries.length, 0);
        const totalUsers = Object.keys(groupedDiaries).length;

        const statsCard = document.createElement('div');
        statsCard.className = 'happxi-admin rounded-2xl p-6 mb-6';
        statsCard.innerHTML = `
            <h3 class="text-xl font-bold mb-4 text-gray-800">ğŸ‘‘ í–…ì”¨ ê´€ë¦¬ì ëŒ€ì‹œë³´ë“œ</h3>
            <div class="grid grid-cols-3 gap-4 text-center">
                <div>
                    <div class="text-2xl font-bold text-purple-600">${totalUsers}</div>
                    <div class="text-sm text-gray-600">í™œì„± ì‚¬ìš©ì</div>
                </div>
                <div>
                    <div class="text-2xl font-bold text-blue-600">${totalDiaries}</div>
                    <div class="text-sm text-gray-600">ì´ ê¸°ë¡</div>
                </div>
                <div>
                    <div class="text-2xl font-bold text-green-600">${getTodayDiariesCount()}</div>
                    <div class="text-sm text-gray-600">ì˜¤ëŠ˜ ê¸°ë¡</div>
                </div>
            </div>
        `;
        diaryList.appendChild(statsCard);

        Object.entries(groupedDiaries).forEach(([userId, group]) => {
            const userCard = createAdminUserCard(group.user, group.diaries);
            diaryList.appendChild(userCard);
        });
    }
    
    function createAdminUserCard(user, diaries) {
        const userCard = document.createElement('div');
        userCard.className = 'happxi-admin rounded-2xl p-5 mb-6';
        const sortedDiaries = diaries.sort((a, b) => new Date(b.date) - new Date(a.date));
        userCard.innerHTML = `
            <div class="flex items-center justify-between mb-4">
                <div class="flex items-center">
                    <div class="w-12 h-12 rounded-full bg-gradient-to-r from-purple-400 to-pink-400 flex items-center justify-center text-white font-bold mr-3">
                        ${user.avatar}
                    </div>
                    <div>
                        <h4 class="font-bold text-gray-800">${user.name}</h4>
                        <p class="text-sm text-gray-600">${user.id}</p>
                    </div>
                </div>
                <span class="bg-gray-100 text-gray-800 px-3 py-1 rounded-full text-xs">
                    ${diaries.length}ê°œì˜ ê¸°ë¡
                </span>
            </div>
            <div class="space-y-3" id="user-diaries-${user.id}">
                ${sortedDiaries.slice(0, 3).map(diary => {
                    const isNew = isWithin7Days(diary.date);
                    return `
                        <div class="privacy-protected rounded-xl p-3 cursor-pointer hover:shadow-md transition">
                            <div class="flex items-center justify-between mb-1">
                                <h5 class="font-medium text-gray-800 text-sm">
                                    ${diary.title || 'ì œëª© ì—†ìŒ'}
                                    ${isNew ? '<span class="new-badge ml-2">NEW</span>' : ''}
                                </h5>
                                <span class="text-lg">${diary.emotion}</span>
                            </div>
                            <p class="text-xs text-gray-600 line-clamp-2">${diary.content}</p>
                            <div class="mt-1 text-xs text-gray-500">${formatDate(diary.date)} â€¢ ${diary.moodName}</div>
                        </div>
                    `;
                }).join('')}
            </div>
            ${diaries.length > 3 ? `
                <button onclick="alert('ë”ë³´ê¸° ê¸°ëŠ¥ì€ êµ¬í˜„ ì¤‘ì…ë‹ˆë‹¤!')" class="text-sm text-purple-600 font-medium mt-3">
                    ë”ë³´ê¸° (${diaries.length - 3}ê°œ)
                </button>
            ` : ''}
        `;
        return userCard;
    }

    function createDiaryCard(diary, isNew) {
        const card = document.createElement('div');
        card.className = 'privacy-protected';
        card.innerHTML = `
            <div class="flex items-start">
                <div class="text-center mr-4">
                    <div class="text-2xl mb-1">${new Date(diary.date).getDate()}</div>
                    <div class="text-xs text-gray-500">${formatDate(diary.date).split(' ')[0]}</div>
                </div>
                <div class="flex-1">
                    <div class="flex items-center justify-between mb-2">
                        <h3 class="font-bold text-gray-800">
                            ${diary.title || 'ì œëª© ì—†ìŒ'}
                            ${isNew ? '<span class="new-badge ml-2">NEW</span>' : ''}
                        </h3>
                        <span class="text-2xl">${diary.emotion}</span>
                    </div>
                    <p class="text-sm text-gray-600 line-clamp-2">${diary.content}</p>
                    <div class="mt-2 text-xs text-gray-500">${diary.moodName}</div>
                </div>
            </div>
        `;
        return card;
    }

    function formatDate(dateString) {
        const date = new Date(dateString);
        return date.toLocaleDateString('ko-KR', {
            month: 'long',
            day: 'numeric',
            year: date.getFullYear() !== new Date().getFullYear() ? 'numeric' : undefined
        });
    }

    function isWithin7Days(diaryDate) {
        const diary = new Date(diaryDate);
        const today = new Date();
        const diffTime = Math.abs(today - diary);
        const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));
        return diffDays <= 7;
    }

    function getTodayDiariesCount() {
        const today = new Date().toISOString().split('T')[0];
        return appData.diaries.filter(diary => diary.date === today).length;
    }
    
    // í˜ì´ì§€ ë„¤ë¹„ê²Œì´ì…˜
    function navigateTo(page, event) {
        if (event) event.preventDefault();

        // ì¸ì¦ëœ ì‚¬ìš©ìë§Œ ì ‘ê·¼ ê°€ëŠ¥í•œ í˜ì´ì§€ ì²´í¬
        if (page !== 'auth' && !appData.currentUser) {
            alert('ë¡œê·¸ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤.');
            return;
        }

        document.querySelectorAll('section').forEach(section => section.classList.add('hide'));

        const targetPageId = page === 'auth' ? 'authPage' : page + 'Page';
        const targetPage = document.getElementById(targetPageId);
        
        if (targetPage) {
            targetPage.classList.remove('hide');
            targetPage.classList.add('fade-in');
        }

        // ë„¤ë¹„ê²Œì´ì…˜ í™œì„±í™” ìƒíƒœ ì—…ë°ì´íŠ¸
        document.querySelectorAll('.nav-item, .jahyu-lab-btn').forEach(item => item.classList.remove('active'));
        
        // í´ë¦­ëœ ìš”ì†Œê°€ nav-item ë˜ëŠ” jahyu-lab-btnì¸ ê²½ìš° active í´ë˜ìŠ¤ ì¶”ê°€
        if (event) {
            const clickedElement = event.currentTarget;
            if (clickedElement.classList.contains('nav-item')) {
                clickedElement.classList.add('active');
            } else if (clickedElement.classList.contains('jahyu-lab-btn')) {
                // ìíœ´ë© ë²„íŠ¼ í´ë¦­ ì‹œ, nav-item active í´ë˜ìŠ¤ ëŒ€ì‹  ìŠ¤íƒ€ì¼ ìœ ì§€
            }
        }
        
        // í˜ì´ì§€ ìƒˆë¡œê³ ì¹¨ ë¡œì§
        currentTab = page;
        if (page === 'sanctuary') {
            renderDiaries();
        } else if (page === 'editorTalk') {
            renderEditorTalks();
        } else if (page === 'newsletter') {
            renderLetters(currentFilter);
        } else if (page === 'jahyuLab') {
            // ìíœ´ë© ë²„íŠ¼ í´ë¦­ ì‹œ ë ˆí„° í˜ì´ì§€ë¡œ ì´ë™í•˜ë©° ìíœ´ë© í•„í„° ì ìš©
            renderLetters('ìíœ´ë©');
            // ë„¤ë¹„ê²Œì´ì…˜ active ìƒíƒœë„ 'ë ˆí„°'ë¡œ ë³´ì´ë„ë¡ ì„¤ì • (ì„ íƒ ì‚¬í•­)
            document.querySelector('.nav-item:nth-child(2)').classList.add('active'); 
        }
    }

    function showSignup() {
        alert('íšŒì›ê°€ì… ê¸°ëŠ¥ì´ ê³§ ì¶”ê°€ë  ì˜ˆì •ì…ë‹ˆë‹¤! ğŸ’');
    }
    
    function setupEventListeners() {
        // ... (ê¸°íƒ€ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ)
    }

    window.addEventListener('DOMContentLoaded', initApp);
</script>

</body>
</html>
